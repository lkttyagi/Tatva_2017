/*! jQuery Browser - v0.1.0 - 3/23/2012
* https://github.com/jquery/jquery-browser
* Copyright (c) 2012 John Resig; Licensed MIT */
/*
	THIS IS A STRIPPED VERSION OF THE ORIGINAL LIBRARY!
*/
/* Modernizr 2.5.3 (Custom Build) | MIT & BSD
 * Build: http://www.modernizr.com/download/#-csstransforms3d-prefixed-teststyles-testprop-testallprops-prefixes-domprefixes
 */
/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
/*
 * @name wowBook
 *
 * @author Marcio Aguiar
 * @version 1.2.1
 * @requires jQuery v1.7.0
 *
 * Copyright 2010 Marcio Aguiar. All rights reserved.
 *
 * To use this file you must to buy a license at http://codecanyon.net/user/maguiar01/portfolio
 *
 * Date: Wed Dec 8 10:05:49 2010 -0200
 */
(function(d){if(!d.browser){var r;r=navigator.userAgent||"";d.uaMatch=function(d){d=d.toLowerCase();d=/(chrome)[ \/]([\w.]+)/.exec(d)||/(webkit)[ \/]([\w.]+)/.exec(d)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(d)||/(msie) ([\w.]+)/.exec(d)||0>d.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(d)||[];return{browser:d[1]||"",version:d[2]||"0"}};r=d.uaMatch(r);d.browser={};r.browser&&(d.browser[r.browser]=!0,d.browser.version=r.version);d.browser.webkit&&(d.browser.safari=!0)}})(jQuery);
jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{easeOutCubic:function(d,r,v,t,m){return t*((r=r/m-1)*r*r+1)+v},easeOutExpo:function(d,r,v,t,m){return r==m?v+t:t*(-Math.pow(2,-10*r/m)+1)+v}});
window.Modernizr=function(d,r,v){function t(a,b){for(var c in a)if(z[a[c]]!==v)return"pfx"==b?a[c]:!0;return!1}function m(a,b,c){var e=a.charAt(0).toUpperCase()+a.substr(1),f=(a+" "+w.join(e+" ")+e).split(" ");if("string"===typeof b||"undefined"===typeof b)b=t(f,b);else a:{f=(a+" "+A.join(e+" ")+e).split(" "),a=f;for(var d in a)if(e=b[a[d]],e!==v){b=!1===c?a[d]:"function"===typeof e?e.bind(c||b):e;break a}b=!1}return b}var k={},q=r.documentElement,n=r.createElement("modernizr"),z=n.style;d=" -webkit- -moz- -o- -ms- ".split(" ");
var w=["Webkit","Moz","O","ms"],A=["webkit","moz","o","ms"],n={},a=[],b=a.slice,c,e=function(a,b,c,e){var f,d,h,g=r.createElement("div"),k=r.body,m=k?k:r.createElement("body");if(parseInt(c,10))for(;c--;)h=r.createElement("div"),h.id=e?e[c]:"modernizr"+(c+1),g.appendChild(h);return f=["&#173;<style>",a,"</style>"].join(""),g.id="modernizr",(k?g:m).innerHTML+=f,m.appendChild(g),k||(m.style.background="",q.appendChild(m)),d=b(g,a),k?g.parentNode.removeChild(g):m.parentNode.removeChild(m),!!d},f={}.hasOwnProperty,
h;"undefined"===typeof f||"undefined"===typeof f.call?h=function(a,b){return b in a&&"undefined"===typeof a.constructor.prototype[b]}:h=function(a,b){return f.call(a,b)};Function.prototype.bind||(Function.prototype.bind=function(a){var c=this;if("function"!=typeof c)throw new TypeError;var e=b.call(arguments,1),f=function(){if(this instanceof f){var d=function(){};d.prototype=c.prototype;var d=new d,h=c.apply(d,e.concat(b.call(arguments)));return Object(h)===h?h:d}return c.apply(a,e.concat(b.call(arguments)))};
return f});(function(a,b){var c=a.join(""),f=b.length;e(c,function(a,b){for(var c=a.childNodes,e={};f--;)e[c[f].id]=c[f];k.csstransforms3d=9===(e.csstransforms3d&&e.csstransforms3d.offsetLeft)&&3===e.csstransforms3d.offsetHeight},f,b)})([,["@media (",d.join("transform-3d),("),"modernizr){#csstransforms3d{left:9px;position:absolute;height:3px;}}"].join("")],[,"csstransforms3d"]);n.csstransforms3d=function(){var a=!!m("perspective");return a&&"webkitPerspective"in q.style&&(a=k.csstransforms3d),a};
for(var g in n)h(n,g)&&(c=g.toLowerCase(),k[c]=n[g](),a.push((k[c]?"":"no-")+c));z.cssText="";return n=null,k._version="2.5.3",k._prefixes=d,k._domPrefixes=A,k._cssomPrefixes=w,k.testProp=function(a){return t([a])},k.testAllProps=m,k.testStyles=e,k.prefixed=function(a,b,c){return b?m(a,b,c):m(a,"pfx")},k}(this,this.document);
(function(d,r,v){function t(d){d=d||location.href;return"#"+d.replace(/^[^#]*#?(.*)$/,"$1")}"$:nomunge";var m=document,k,q=d.event.special,n=m.documentMode,z="onhashchange"in r&&(n===v||7<n);d.fn.hashchange=function(d){return d?this.bind("hashchange",d):this.trigger("hashchange")};d.fn.hashchange.delay=50;q.hashchange=d.extend(q.hashchange,{setup:function(){if(z)return!1;d(k.start)},teardown:function(){if(z)return!1;d(k.stop)}});k=function(){function k(){var c=t(),g=f(b);c!==b?(e(b=c,g),d(r).trigger("hashchange")):
g!==b&&(location.href=location.href.replace(/#.*/,"")+g);a=setTimeout(k,d.fn.hashchange.delay)}var n={},a,b=t(),c=function(a){return a},e=c,f=c;n.start=function(){a||k()};n.stop=function(){a&&clearTimeout(a);a=v};d.browser.msie&&!z&&function(){var a,b;n.start=function(){a||(b=(b=d.fn.hashchange.src)&&b+t(),a=d('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){b||e(t());k()}).attr("src",b||"javascript:0").insertAfter("body")[0].contentWindow,m.onpropertychange=function(){try{"title"===
event.propertyName&&(a.document.title=m.title)}catch(b){}})};n.stop=c;f=function(){return t(a.location.href)};e=function(b,c){var e=a.document,f=d.fn.hashchange.domain;b!==c&&(e.title=m.title,e.open(),f&&e.write('<script>document.domain="'+f+'"\x3c/script>'),e.close(),a.location.hash=b)}}();return n}()})(jQuery,this);
try{(function(d,r,v,t){function m(a,b,c){return setTimeout(A(a,c),b)}function k(a,b,c){return Array.isArray(a)?(q(a,c[b],c),!0):!1}function q(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==t)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function n(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;){if(!c||c&&a[e[f]]===t)a[e[f]]=b[e[f]];f++}return a}function z(a,b){return n(a,b,!0)}function w(a,b,c){b=b.prototype;var e;e=a.prototype=
Object.create(b);e.constructor=a;e._super=b;c&&n(e,c)}function A(a,b){return function(){return a.apply(b,arguments)}}function a(a,b){return"function"==typeof a?a.apply(b?b[0]||t:t,b):a}function b(a,b,c){q(f(b),function(b){a.addEventListener(b,c,!1)})}function c(a,b,c){q(f(b),function(b){a.removeEventListener(b,c,!1)})}function e(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function f(a){return a.trim().split(/\s+/g)}function h(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var e=0;e<a.length;){if(c&&
a[e][c]==b||!c&&a[e]===b)return e;e++}return-1}function g(a){return Array.prototype.slice.call(a,0)}function l(a,b,c){for(var e=[],f=[],d=0;d<a.length;){var g=b?a[d][b]:a[d];0>h(f,g)&&e.push(a[d]);f[d]=g;d++}c&&(e=b?e.sort(function(a,c){return a[b]>c[b]}):e.sort());return e}function p(a,b){for(var c,e=b[0].toUpperCase()+b.slice(1),f=0;f<ca.length;){c=(c=ca[f])?c+e:b;if(c in a)return c;f++}return t}function O(a){a=a.ownerDocument;return a.defaultView||a.parentWindow}function u(b,c){var e=this;this.manager=
b;this.callback=c;this.element=b.element;this.target=b.options.inputTarget;this.domHandler=function(c){a(b.options.enable,[b])&&e.handler(c)};this.init()}function C(a){var b=a.options.inputClass;return new (b?b:na?P:oa?I:da?Q:J)(a,ma)}function ma(a,b,c){var f=c.pointers.length,d=c.changedPointers.length,h=b&1&&0===f-d;c.isFirst=!!h;c.isFinal=!!(b&12&&0===f-d);h&&(a.session={});c.eventType=b;b=a.session;f=c.pointers;d=f.length;b.firstInput||(b.firstInput=Z(c));1<d&&!b.firstMultiple?b.firstMultiple=
Z(c):1===d&&(b.firstMultiple=!1);var h=b.firstInput,g=(d=b.firstMultiple)?d.center:h.center,l=c.center=aa(f);c.timeStamp=R();c.deltaTime=c.timeStamp-h.timeStamp;c.angle=S(g,l);c.distance=H(g,l);var h=c.center,g=b.offsetDelta||{},l=b.prevDelta||{},p=b.prevInput||{};if(1===c.eventType||4===p.eventType)l=b.prevDelta={x:p.deltaX||0,y:p.deltaY||0},g=b.offsetDelta={x:h.x,y:h.y};c.deltaX=l.x+(h.x-g.x);c.deltaY=l.y+(h.y-g.y);c.offsetDirection=ba(c.deltaX,c.deltaY);d?(h=d.pointers,h=H(f[0],f[1],K)/H(h[0],
h[1],K)):h=1;c.scale=h;d?(d=d.pointers,f=S(f[1],f[0],K)-S(d[1],d[0],K)):f=0;c.rotation=f;g=b.lastInterval||c;f=c.timeStamp-g.timeStamp;8!=c.eventType&&(25<f||g.velocity===t)?(h=g.deltaX-c.deltaX,g=g.deltaY-c.deltaY,l=h/f||0,p=g/f||0,f=l,d=p,l=G(l)>G(p)?l:p,h=ba(h,g),b.lastInterval=c):(l=g.velocity,f=g.velocityX,d=g.velocityY,h=g.direction);c.velocity=l;c.velocityX=f;c.velocityY=d;c.direction=h;b=a.element;e(c.srcEvent.target,b)&&(b=c.srcEvent.target);c.target=b;a.emit("hammer.input",c);a.recognize(c);
a.session.prevInput=c}function Z(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:F(a.pointers[c].clientX),clientY:F(a.pointers[c].clientY)},c++;return{timeStamp:R(),pointers:b,center:aa(b),deltaX:a.deltaX,deltaY:a.deltaY}}function aa(a){var b=a.length;if(1===b)return{x:F(a[0].clientX),y:F(a[0].clientY)};for(var c=0,e=0,f=0;f<b;)c+=a[f].clientX,e+=a[f].clientY,f++;return{x:F(c/b),y:F(e/b)}}function ba(a,b){return a===b?1:G(a)>=G(b)?0<a?2:4:0<b?8:16}function H(a,b,c){c||(c=ea);var e=b[c[0]]-
a[c[0]];a=b[c[1]]-a[c[1]];return Math.sqrt(e*e+a*a)}function S(a,b,c){c||(c=ea);return 180*Math.atan2(b[c[1]]-a[c[1]],b[c[0]]-a[c[0]])/Math.PI}function J(){this.evEl=pa;this.evWin=qa;this.allow=!0;this.pressed=!1;u.apply(this,arguments)}function P(){this.evEl=fa;this.evWin=ga;u.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}function ha(){this.evTarget="touchstart";this.evWin="touchstart touchmove touchend touchcancel";this.started=!1;u.apply(this,arguments)}function I(){this.evTarget=
ra;this.targetIds={};u.apply(this,arguments)}function sa(a,b){var c=g(a.touches),f=this.targetIds;if(b&3&&1===c.length)return f[c[0].identifier]=!0,[c,c];var d,h=g(a.changedTouches),p=[],u=this.target;d=c.filter(function(a){return e(a.target,u)});if(1===b)for(c=0;c<d.length;)f[d[c].identifier]=!0,c++;for(c=0;c<h.length;)f[h[c].identifier]&&p.push(h[c]),b&12&&delete f[h[c].identifier],c++;if(p.length)return[l(d.concat(p),"identifier",!0),p]}function Q(){u.apply(this,arguments);var a=A(this.handler,
this);this.touch=new I(this.manager,a);this.mouse=new J(this.manager,a)}function T(a,b){this.manager=a;this.set(b)}function ta(a){if(-1<a.indexOf("none"))return"none";var b=-1<a.indexOf("pan-x"),c=-1<a.indexOf("pan-y");return b&&c?"pan-x pan-y":b||c?b?"pan-x":"pan-y":-1<a.indexOf("manipulation")?"manipulation":"auto"}function D(a){this.id=ua++;this.manager=null;this.options=z(a||{},this.defaults);a=this.options.enable;this.options.enable=a===t?!0:a;this.state=1;this.simultaneous={};this.requireFail=
[]}function ia(a){return 16==a?"down":8==a?"up":2==a?"left":4==a?"right":""}function L(a,b){var c=b.manager;return c?c.get(a):a}function B(){D.apply(this,arguments)}function M(){B.apply(this,arguments);this.pY=this.pX=null}function U(){B.apply(this,arguments)}function V(){D.apply(this,arguments);this._input=this._timer=null}function W(){B.apply(this,arguments)}function X(){B.apply(this,arguments)}function N(){D.apply(this,arguments);this.pCenter=this.pTime=!1;this._input=this._timer=null;this.count=
0}function E(a,b){b=b||{};var c=b.recognizers;b.recognizers=c===t?E.defaults.preset:c;return new Y(a,b)}function Y(a,b){b=b||{};this.options=z(b,E.defaults);this.options.inputTarget=this.options.inputTarget||a;this.handlers={};this.session={};this.recognizers=[];this.element=a;this.input=C(this);this.touchAction=new T(this,this.options.touchAction);ja(this,!0);q(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]);a[3]&&b.requireFailure(a[3])},this)}function ja(a,b){var c=
a.element;q(a.options.cssProps,function(a,e){c.style[p(c.style,e)]=b?a:""})}function va(a,b){var c=r.createEvent("Event");c.initEvent(a,!0,!0);c.gesture=b;b.target.dispatchEvent(c)}var ca=" webkit moz MS ms o".split(" "),wa=r.createElement("div"),F=Math.round,G=Math.abs,R=Date.now,ua=1,xa=/mobile|tablet|ip(ad|hone|od)|android/i,da="ontouchstart"in d,na=p(d,"PointerEvent")!==t,oa=da&&xa.test(navigator.userAgent),ea=["x","y"],K=["clientX","clientY"];u.prototype={handler:function(){},init:function(){this.evEl&&
b(this.element,this.evEl,this.domHandler);this.evTarget&&b(this.target,this.evTarget,this.domHandler);this.evWin&&b(O(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&c(this.element,this.evEl,this.domHandler);this.evTarget&&c(this.target,this.evTarget,this.domHandler);this.evWin&&c(O(this.element),this.evWin,this.domHandler)}};var ya={mousedown:1,mousemove:2,mouseup:4},pa="mousedown",qa="mousemove mouseup";w(J,u,{handler:function(a){var b=ya[a.type];b&1&&0===a.button&&(this.pressed=
!0);b&2&&1!==a.which&&(b=4);this.pressed&&this.allow&&(b&4&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:"mouse",srcEvent:a}))}});var za={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Aa={2:"touch",3:"pen",4:"mouse",5:"kinect"},fa="pointerdown",ga="pointermove pointerup pointercancel";d.MSPointerEvent&&(fa="MSPointerDown",ga="MSPointerMove MSPointerUp MSPointerCancel");w(P,u,{handler:function(a){var b=this.store,c=!1,e=a.type.toLowerCase().replace("ms",
""),e=za[e],f=Aa[a.pointerType]||a.pointerType,d="touch"==f,g=h(b,a.pointerId,"pointerId");e&1&&(0===a.button||d)?0>g&&(b.push(a),g=b.length-1):e&12&&(c=!0);0>g||(b[g]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(g,1))}});var Ba={touchstart:1,touchmove:2,touchend:4,touchcancel:8};w(ha,u,{handler:function(a){var b=Ba[a.type];1===b&&(this.started=!0);if(this.started){var c;c=g(a.touches);var e=g(a.changedTouches);b&12&&(c=l(c.concat(e),"identifier",
!0));c=[c,e];b&12&&0===c[0].length-c[1].length&&(this.started=!1);this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}}});var Ca={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ra="touchstart touchmove touchend touchcancel";w(I,u,{handler:function(a){var b=Ca[a.type],c=sa.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}});w(Q,u,{handler:function(a,b,c){var e="mouse"==c.pointerType;
if("touch"==c.pointerType)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&12&&(this.mouse.allow=!0);this.callback(a,b,c)},destroy:function(){this.touch.destroy();this.mouse.destroy()}});var ka=p(wa.style,"touchAction"),la=ka!==t;T.prototype={set:function(a){"compute"==a&&(a=this.compute());la&&(this.manager.element.style[ka]=a);this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var b=[];q(this.manager.recognizers,function(c){a(c.options.enable,
[c])&&(b=b.concat(c.getTouchAction()))});return ta(b.join(" "))},preventDefaults:function(a){if(!la){var b=a.srcEvent;a=a.offsetDirection;if(this.manager.session.prevented)b.preventDefault();else{var c=this.actions,e=-1<c.indexOf("none"),f=-1<c.indexOf("pan-y"),c=-1<c.indexOf("pan-x");if(e||f&&a&6||c&&a&24)return this.preventSrc(b)}}},preventSrc:function(a){this.manager.session.prevented=!0;a.preventDefault()}};D.prototype={defaults:{},set:function(a){n(this.options,a);this.manager&&this.manager.touchAction.update();
return this},recognizeWith:function(a){if(k(a,"recognizeWith",this))return this;var b=this.simultaneous;a=L(a,this);b[a.id]||(b[a.id]=a,a.recognizeWith(this));return this},dropRecognizeWith:function(a){if(k(a,"dropRecognizeWith",this))return this;a=L(a,this);delete this.simultaneous[a.id];return this},requireFailure:function(a){if(k(a,"requireFailure",this))return this;var b=this.requireFail;a=L(a,this);-1===h(b,a)&&(b.push(a),a.requireFailure(this));return this},dropRequireFailure:function(a){if(k(a,
"dropRequireFailure",this))return this;a=L(a,this);a=h(this.requireFail,a);-1<a&&this.requireFail.splice(a,1);return this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(f){c.manager.emit(c.options.event+(f?e&16?"cancel":e&8?"end":e&4?"move":e&2?"start":"":""),a)}var c=this,e=this.state;8>e&&b(!0);b();8<=e&&b(!0)},tryEmit:function(a){if(this.canEmit())return this.emit(a);this.state=32},canEmit:function(){for(var a=
0;a<this.requireFail.length;){if(!(this.requireFail[a].state&33))return!1;a++}return!0},recognize:function(b){b=n({},b);a(this.options.enable,[this,b])?(this.state&56&&(this.state=1),this.state=this.process(b),this.state&30&&this.tryEmit(b)):(this.reset(),this.state=32)},process:function(a){},getTouchAction:function(){},reset:function(){}};w(B,D,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,
e=b&6;a=this.attrTest(a);return e&&(c&8||!a)?b|16:e||a?c&4?b|8:b&2?b|4:2:32}});w(M,B,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var a=this.options.direction,b=[];a&6&&b.push("pan-y");a&24&&b.push("pan-x");return b},directionTest:function(a){var b=this.options,c=!0,e=a.distance,f=a.direction,d=a.deltaX,h=a.deltaY;f&b.direction||(b.direction&6?(f=0===d?1:0>d?2:4,c=d!=this.pX,e=Math.abs(a.deltaX)):(f=0===h?1:0>h?8:16,c=h!=this.pY,e=Math.abs(a.deltaY)));a.direction=
f;return c&&e>b.threshold&&f&b.direction},attrTest:function(a){return B.prototype.attrTest.call(this,a)&&(this.state&2||!(this.state&2)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX;this.pY=a.deltaY;var b=ia(a.direction);b&&this.manager.emit(this.options.event+b,a);this._super.emit.call(this,a)}});w(U,B,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||
this.state&2)},emit:function(a){this._super.emit.call(this,a);1!==a.scale&&this.manager.emit(this.options.event+(1>a.scale?"in":"out"),a)}});w(V,D,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return["auto"]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,e=a.distance<b.threshold,f=a.deltaTime>b.time;this._input=a;if(!e||!c||a.eventType&12&&!f)this.reset();else if(a.eventType&1)this.reset(),this._timer=m(function(){this.state=8;this.tryEmit()},
b.time,this);else if(a.eventType&4)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){8===this.state&&(a&&a.eventType&4?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=R(),this.manager.emit(this.options.event,this._input)))}});w(W,B,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&2)}});
w(X,B,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:30,pointers:1},getTouchAction:function(){return M.prototype.getTouchAction.call(this)},attrTest:function(a){var b=this.options.direction,c;b&30?c=a.velocity:b&6?c=a.velocityX:b&24&&(c=a.velocityY);return this._super.attrTest.call(this,a)&&b&a.direction&&a.distance>this.options.threshold&&G(c)>this.options.velocity&&a.eventType&4},emit:function(a){var b=ia(a.direction);b&&this.manager.emit(this.options.event+b,a);this.manager.emit(this.options.event,
a)}});w(N,D,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,e=a.distance<b.threshold,f=a.deltaTime<b.time;this.reset();if(a.eventType&1&&0===this.count)return this.failTimeout();if(e&&f&&c){if(4!=a.eventType)return this.failTimeout();c=this.pTime?a.timeStamp-this.pTime<b.interval:!0;e=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;
this.pTime=a.timeStamp;this.pCenter=a.center;this.count=e&&c?this.count+1:1;this._input=a;if(0===this.count%b.taps)return this.hasRequireFailures()?(this._timer=m(function(){this.state=8;this.tryEmit()},b.interval,this),2):8}return 32},failTimeout:function(){this._timer=m(function(){this.state=32},this.options.interval,this);return 32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});E.VERSION=
"2.0.4";E.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[W,{enable:!1}],[U,{enable:!1},["rotate"]],[X,{direction:6}],[M,{direction:6},["swipe"]],[N],[N,{event:"doubletap",taps:2},["tap"]],[V]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};Y.prototype={set:function(a){n(this.options,a);a.touchAction&&this.touchAction.update();a.inputTarget&&(this.input.destroy(),
this.input.target=a.inputTarget,this.input.init());return this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,e=this.recognizers,f=b.curRecognizer;if(!f||f&&f.state&8)f=b.curRecognizer=null;for(var d=0;d<e.length;)c=e[d],2===b.stopped||f&&c!=f&&!c.canRecognizeWith(f)?c.reset():c.recognize(a),!f&&c.state&14&&(f=b.curRecognizer=c),d++}},get:function(a){if(a instanceof D)return a;for(var b=this.recognizers,
c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(k(a,"add",this))return this;var b=this.get(a.options.event);b&&this.remove(b);this.recognizers.push(a);a.manager=this;this.touchAction.update();return a},remove:function(a){if(k(a,"remove",this))return this;var b=this.recognizers;a=this.get(a);b.splice(h(b,a),1);this.touchAction.update();return this},on:function(a,b){var c=this.handlers;q(f(a),function(a){c[a]=c[a]||[];c[a].push(b)});return this},off:function(a,
b){var c=this.handlers;q(f(a),function(a){b?c[a].splice(h(c[a],b),1):delete c[a]});return this},emit:function(a,b){this.options.domEvents&&va(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a;b.preventDefault=function(){b.srcEvent.preventDefault()};for(var e=0;e<c.length;)c[e](b),e++}},destroy:function(){this.element&&ja(this,!1);this.handlers={};this.session={};this.input.destroy();this.element=null}};n(E,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,
STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Y,Input:u,TouchAction:T,TouchInput:I,MouseInput:J,PointerEventInput:P,TouchMouseInput:Q,SingleTouchInput:ha,Recognizer:D,AttrRecognizer:B,Tap:N,Pan:M,Swipe:X,Pinch:U,Rotate:W,Press:V,on:b,off:c,each:q,merge:z,extend:n,inherit:w,bindFn:A,prefixed:p});
"function"==typeof define&&define.amd?define(function(){return E}):"undefined"!=typeof module&&module.exports?module.exports=E:d[v]=E})(window,document,"Hammer")}catch(d){console&&console.log&&console.log(d)}
(function(d){function r(a,b){a=d(a);var c=this;this.elem=a;this.id=a.attr("id");this.pages=[];this.opts=b;this.currentPage=null;this.pageWidth=b.width/2;this.pageHeight=b.height;this.startPage=b.startPage;this.onShowPage=b.onShowPage;this.slideShow=b.slideShow;this.slideShowDelay=b.slideShowDelay;this.pauseOnHover=b.pauseOnHover;this.turnPageDuration=b.turnPageDuration;this.foldGradient=b.foldGradient;this.foldGradientThreshold=b.foldGradientThreshold;this.shadows=b.shadows;this.shadowThreshold=b.shadowThreshold;
this.clipBoundaries=b.clipBoundaries;this.zoomLevel=1;this.zoomMax=Math.max(b.zoomMax,1);this.zoomMin=b.zoomMin;this.zoomBoundingBox=b.zoomBoundingBox;this.zoomStep=b.zoomStep;this.onZoom=b.onZoom;this.mouseWheel=b.mouseWheel;this.flipSound=b.flipSound;this.centeredWhenClosed=b.centeredWhenClosed;this.sectionDefinition=b.sections;this.rtl=!!b.rtl;this.closable=b.closable;d.wowBook.support.filters="filters"in a[0];(this._isMobile=d.wowBook.utils.isMobile())&&this.mobileSetup();a.addClass("wowbook");
"static"===a.css("position")&&a.css("position","relative");var e=a.children();if(e.length<b.pageCount){for(var f=b.pageCount-e.length;f--;)a.append("<div />");e=a.children()}f=this.pagesContainer=this.origin=d("<div class='wowbook-origin'></div>").css({position:"absolute"}).appendTo(a);c.bookShadow=d("<div class='wowbook-book-shadow'></div>").appendTo(a).css({top:0,position:"absolute",display:"none",zIndex:0});this._controls={};this.controllify(this.opts.controls);this.insertPages(e,!0);f.append("<div class='wowbook-shadow-clipper'><div class='wowbook-shadow-container'><div class='wowbook-shadow-internal'></div></div></div>");
c.shadowContainer=d(".wowbook-shadow-container",f);c.internalShadow=d(".wowbook-shadow-internal",f);c.shadowClipper=d(".wowbook-shadow-clipper",f).css({display:"none"});c.foldShadow=d("<div class='wowbook-shadow-fold'></div>").appendTo(c.shadowContainer);c.foldGradientContainer=d("<div class='wowbook-fold-gradient-container'></div>").appendTo(c.shadowContainer);c.foldGradientElem=d("<div class='wowbook-fold-gradient'></div>").appendTo(c.foldGradientContainer);c.hardPageDropShadow=d("<div class='wowbook-hard-page-dropshadow'></div>").css({display:"none"}).appendTo(f);
!d.support.opacity&&d.wowBook.support.filters&&d.wowBook.applyAlphaImageLoader(["wowbook-fold-gradient","wowbook-fold-gradient-flipped","wowbook-shadow-fold","wowbook-shadow-fold-flipped"]);c.shadowContainer.css("position","relative");this.leftHandle=d("<div class='wowbook-handle wowbook-left'></div>").data("corner","l").appendTo(f);this.rightHandle=d("<div class='wowbook-handle wowbook-right'></div>").data("corner","r").appendTo(f);Modernizr.csstransforms3d&&(e=d("<div>").css("transform","perspective(1px)"),
this.perspectiveUnit="none"!=e.css("transform")?"px":"",e=null);d.browser.msie&&d(".wowbook-handle",a).css({backgroundColor:"#fff",opacity:"0.01"});d(".wowbook-handle",f).bind("mousedown.wowbook",function(a){return c.pageEdgeDragStart(a)});b.curl&&d(".wowbook-handle",f).hover(function(a){c.curlTimer||(c.curlTimer=setTimeout(function(){var b=a.target==c.leftHandle[0]?c.leftPage():c.rightPage();if(b){var e=b.offset();c.curl(b,a.pageY-e.top>c.pageHeight*c.currentScale*c._cssZoom/2)}},120))},function(){c.curlTimer=
clearTimeout(c.curlTimer);c.uncurl()});var h,g;d(".wowbook-handle",f).on("mousedown.wowbook",function(){h=d.now();g=d(this).data("corner")}).on("mouseup.wowbook",function(){var a=d(this).data("corner");if(!((new Date).getTime()-h>c.opts.handleClickDuration||a!=g)){c._cantStopAnimation||c.stopAnimation(!1);if("r"===a)c[c.rtl?"back":"advance"]();if("l"===a)c[c.rtl?"advance":"back"]();g=""}});var l=!1;a.hover(function(a){c.pauseOnHover&&(l=c.slideShowTimer,c.stopSlideShow(!0))},function(){c.pauseOnHover&&
l&&c.startSlideShow()});this.clipBoundaries&&(this.origin.wrap("<div class='wowbook-clipper'><div class='wowbook-inner-clipper'></div></div>"),d(".wowbook-inner-clipper",a).css({position:"absolute",width:"100%",overflow:"hidden"}),this.clipper=d(".wowbook-clipper",a).css({position:"absolute",left:0,top:0,width:"100%",overflow:"hidden",zIndex:1}));a.wrapInner("<div class='wowbook-zoomwindow'><div class='wowbook-zoomcontent'></div></div>");this.zoomWindow=d(".wowbook-zoomwindow",a);this.zoomContent=
d(".wowbook-zoomcontent",a);d.browser.ie8mode&&this.zoomContent.wrapInner("<div class='IE8-zoom-helper'style='position:relative'></div>");this.zoomWindow.css({position:"absolute",top:0});this.zoomContent.css({position:"absolute",left:0,top:0});this.zoomSetup();this.setDimensions(2*b.coverWidth||b.width,b.coverHeight||b.height);this.singlePage(b.singlePage);b.responsiveSinglePage&&this.responsiveSinglePage();b.scaleToFit&&(this.scaleToFit(),this.responsive());this.fillToc();f=b.useTranslate3d;Modernizr.csstransforms3d&&
f&&(d.wowBook.useTranslate3d=1==f||"mobile"==f&&d.wowBook.utils.isMobile());b.useScale3d=b.useScale3d&&Modernizr.csstransforms3d;if(b.deepLinking&&this.getLocationHash()){var p;try{p=c.selectorToPage("#"+this.getLocationHash())}catch(O){}void 0===p&&(p=c.locationHashToPage());"number"===typeof p&&(c.startPage=p,b.moveToViewPort&&!t(c.elem)&&c.elem[0].scrollIntoView())}this.flipSound&&(this.audio=this.createAudioPlayer());this.opts.keyboardNavigation&&(p=d.wowBook.defaults.keyboardNavigation,this.rtl&&
this.opts.keyboardNavigation==p&&(this.opts.keyboardNavigation={back:p.advance,advance:p.back}),d(document).on("keydown.wowbook",function(a){d(a.target).filter("input, textarea, select").length||(a.which===c.opts.keyboardNavigation.back&&c.back(),a.which===c.opts.keyboardNavigation.advance&&c.advance())}));d(window).on("hashchange.wowbook",function(){var a=window.location.hash;if(a===c.locationHashSetTo)c.locationHashSetTo=void 0;else{var e=(a=""===a&&!c.locationEndsInHash())?c.startPage:c.locationHashToPage();
"number"===typeof e&&(c.gotoPage(e,!a),a||!b.moveToViewPort||t(c.elem)||c.elem[0].scrollIntoView())}});b.forceBasicPage&&(this.foldPage=this.holdHardpage=this.foldPageBasic);d.wowBook.support.transform||(this.foldPage=this.foldPageBasic,d.wowBook.support.filters||(this.holdHardpage=this.foldPageBasic));this.mouseWheel&&("zoom"==c.mouseWheel&&a.bind("mousemove.wowbook mouseenter.wowbook",function(a){c._mousemoveEvent=a}),a.mousewheel(function(a,b){if(c.mouseWheel){if("zoom"===c.mouseWheel){var e=c.elem.offset(),
f=c._mousemoveEvent,d=f.pageX-e.left,e=f.pageY-e.top;0<b&&c.zoomIn({x:d,y:e});0>b&&c.zoomOut({x:d,y:e})}else 0<b&&c.advance(),0>b&&c.back();return!1}}));this.opts.touchEnabled&&this.touchSupport();b.toc&&this.createToc();this.opts.thumbnails&&this.createThumbnails();this.setupFullscreen();this.showPage(this.startPage,!1);1!=this.opts.zoomLevel&&this.zoom(this.opts.zoomLevel,{duration:0});this.opts.pdf&&this.setPDF(this.opts.pdf);this.opts.lightbox&&this.lightbox(this.opts.lightbox);this.toolbars=
[];this.opts.toolbar&&(this.createToolbar(this.opts.toolbar),this._isMobile&&this.opts.lightbox&&this.setupMobileToolbar());this.callRAFCallback=function(){c.rafCallback()};window.raf(this.callRAFCallback);b.slideShow&&this.startSlideShow()}function v(a,b){var c=Math.cos(b),e=Math.sin(b);return{x:c*a.x-e*a.y,y:e*a.x+c*a.y}}function t(a){var b=d(window).height(),c=a.offset(),e=d(window).scrollTop();return c.top>e&&c.top+a.height()<e+b}function m(a,b,c){var e,f,h,g;e=f=0;if(!d.wowBook.support.boxSizing){var l;
e="none"==a.css("borderTopStyle")?0:q[l=a.css("borderTopWidth")]||parseFloat(l);f="none"==a.css("borderRightStyle")?0:q[l=a.css("borderRightWidth")]||parseFloat(l);h="none"==a.css("borderBottomStyle")?0:q[l=a.css("borderBottomWidth")]||parseFloat(l);g="none"==a.css("borderLeftStyle")?0:q[l=a.css("borderLeftWidth")]||parseFloat(l);f=parseFloat(a.css("paddingLeft"))+parseFloat(a.css("paddingRight"))+g+f;e=parseFloat(a.css("paddingTop"))+parseFloat(a.css("paddingBottom"))+e+h}a.css("width",b-f);a.css("height",
c-e)}d.wowBook=function(a){return d(a).data("wowBook")};d.wowBook.version="1.2.0";d.wowBook.support={};d.fn.wowBook=function(a){if("string"===typeof a){var b=Array.prototype.slice.call(arguments,1);if("options"===a||"prop"===a){var c=d.wowBook(this[0]),e=b[0];return 1<b.length?c[e]=b[1]:c[e]}return this.each(function(){var c=d.wowBook(this);c[a].apply(c,b)})}var f=d.extend({},d.wowBook.defaults,a);return this.each(function(){if(d.wowBook(this))console.log("Error: the following element cannot be used twice by wowBook plugin: ",
this);else{var a=new r(this,f);d(this).data("wowBook",a)}})};r.prototype={destroy:function(){this.callRAFCallback=d.noop;this.curlTimer=clearTimeout(this.curlTimer);d("*").add(document).add(window).off(".wowbook");this.destroyThumbnails();this.destroyToc();this.destroyToolbars();this.destroyLightbox();this.stopSlideShow();this.stopAnimation(!1);this.elem.empty().removeData().off()},mobileSetup:function(){this.opts.hardPageShadow=!1},setDimensions:function(a,b){this.zoomed&&this.zoomReset(0);this.currentScale=
1;var c=this.elem,e=this.pageWidth;c.css({height:b,width:a});var f=c.height();this.pageWidth=c.width()/2;this.pageHeight=f;this._originalHeight||(this._originalHeight=this.pageHeight);this._originalWidth||(this._originalWidth=2*this.pageWidth);var h=this.origin.css({width:"100%",height:f});if(e&&this.centeredWhenClosed){var g=parseFloat(h.css("left"),10);h.css("left",g/(e/this.pageWidth))}this.bookShadow.css({width:a,height:b});this.setPagesDimension();this.positionBookShadow();this.shadowClipper.css({width:c.width(),
height:f});this.hardPageDropShadow.css({width:this.pageWidth,height:this.pageHeight});this.opts.handleWidth&&d(".wowbook-handle",h).css("width",this.opts.handleWidth);this.rightHandle.css("left",a-this.rightHandle.width());this.clipBoundaries&&(e=Math.ceil(Math.sqrt(this.pageWidth*this.pageWidth+this.pageHeight*this.pageHeight)),e=[this.pageHeight-e,c.width(),e,0],this.origin.css("top",-e[0]),d(".wowbook-inner-clipper",c).css({width:"100%",height:e[2]-e[0],top:e[0]}),this.clipper.css({width:"100%",
height:f}));this.zoomWindow.css({width:2*this.pageWidth,height:f});this.zoomContent.css({width:2*this.pageWidth,height:f});this.corners={tl:[0,0],bl:[0,this.pageHeight],tr:[this.pageWidth,0],br:[this.pageWidth,this.pageHeight],l:[0,0],r:[this.pageWidth,0]};this.pdf&&this.pdfResetPages();this.thumbnails&&this.updateThumbnails()},setPagesDimension:function(){for(var a,b,c,e=0,f=this.pages.length;e<f;e++)page=this.pages[e],b=page.isCover?this.pageWidth:this.opts.pageWidth||this.pageWidth,c=page.isCover?
this.pageHeight:this.opts.pageHeight||this.pageHeight,page.pageWidth=b,page.pageHeight=c,page.css({width:b,height:c,left:page.onLeft?0:this.pageWidth}),a=d(".wowbook-page-content",page),m(a,b,c),this.setPageCorners(page),this.opts.gutterShadow&&d(".wowbook-gutter-shadow",this.elem).css("height",c)},setPageCorners:function(a){var b=0+a.pageWidth,c=0+a.pageHeight;a.corners={tl:[0,0],bl:[0,c],tr:[b,0],br:[b,c],l:[0,0],r:[b,0]}},setPagePosition:function(a){a.left=a.onLeft?this.pageWidth-a.pageWidth:this.pageWidth;
a.top=Math.floor((this.pageHeight-a.pageHeight)/2);a.css({left:a.left,top:a.top})},scale:function(a){if(d.wowBook.support.transform){this.zoomed&&this.zoom(1,0,{offset:{dx:0,dy:0}});this.currentScale=a;var b=this.zoomContent;this.opts.zoomUsingTransform?b.css({transform:"scale("+a+")",transformOrigin:"0 0"}):(b.css("zoom",a),this._cssZoom=a*this.zoomLevel);this.elem.css({height:this._originalHeight*a,width:this._originalWidth*a});this.zoomWindow.css({height:this._originalHeight*a,width:this._originalWidth*
a});this.resizeHandles();if(this.opts.onResize)this.opts.onResize(this)}},scaleToFit:function(a,b){var c=a;if(!d.isNumeric(a)){var e=d(a||this.opts.scaleToFit);if(!e.length)throw"jQuery selector passed to wowbook.resize did not matched in any DOM element.";c=e.width();b=e.height()}this.opts.maxWidth&&c>this.opts.maxWidth&&(c=this.opts.maxWidth);this.opts.maxHeight&&b>this.opts.maxHeight&&(b=this.opts.maxHeight);this._singlePage&&(c*=2);e=this._originalWidth/this._originalHeight;b*e<=c||(b=c/e);this.scale(b/
this._originalHeight)},resize:function(a,b){this.setDimensions(a,b);if(this.opts.onResize)this.opts.onResize(this)},responsive:function(){var a=this;d(window).on("resize.wowbook",function(){a.responsiveUpdater()})},responsiveUpdater:function(){this.responsiveSinglePage();this.scaleToFit();this.lightboxOn&&this.centerLightbox()},responsiveSinglePage:function(a){if(a=void 0!=a?a:this.opts.responsiveSinglePage)d.isFunction(a)||(a=function(a){if(!this._isMobile)return!1;a=d(a.opts.scaleToFit);var c=a.width();
return a.height()>c}),this.singlePage(this.opts.singlePage||a.call(this,this))},resizeHandles:function(){if(this.opts.responsiveHandleWidth){var a=this.opts.responsiveHandleWidth/this.currentScale;d(".wowbook-handle").width(a);this.rightHandle.css("left",2*this.pageWidth-a)}},insertPages:function(a,b){for(var c=0,e=a.length;c<e;c++)this.insertPage(a[c],!0);this.updateBook(b)},insertPage:function(a,b){if(this.isDoublePage(a))this.insertDoublePage(a,b);else{a=d(a).addClass("wowbook-page-content");var c=
d("<div class='wowbook-page'></div>").css({width:this.pageWidth,height:this.pageHeight,display:"none",position:"absolute"}).appendTo(this.pagesContainer).append(a);d.wowBook.support.boxSizing&&a.css(d.wowBook.support.boxSizing,"border-box");m(a,this.pageWidth,this.pageHeight);c.hardPageSetByUser=a.hasClass("wowbook-hardpage");this.opts.gutterShadow&&this.upsertGutterShadowInPage(c);this.pages.push(c);b||this.updateBook();return c}},insertDoublePage:function(a,b){if(!this._insertingDoublePage){this._insertingDoublePage=
!0;var c=d(a),e=c.clone().insertAfter(c),f=c.add(e);c.css("left",0);e.css("right","100%");f.css({width:"200%",height:"100%",position:"relative"});f.css(d.wowBook.support.boxSizing+"","border-box").wrap("<div class='wowbook-double-page'></div>");c.parent().data("src",c.data("src"));e.parent().data("src",e.data("src"));c.parent().data("image",c.data("image"));e.parent().data("image",e.data("image"));var f=this.insertPage(c.parent(),!0),h=this.insertPage(e.parent(),!0);f&&(f.otherHalf=h);h&&(h.otherHalf=
f);d.wowBook.support.boxSizing||(m(c,2*this.pageWidth,this.pageHeight),m(e,2*this.pageWidth,this.pageHeight));b||this.updateBook();this._insertingDoublePage=!1}},isDoublePage:function(a){a=d(a);return a.data("double")||a.is(this.opts.doublePages)},replaceNumberHolder:function(a,b){if(void 0==a)return a;b+="";return a.replace(/\{\{([^}]+)\}\}/g,function(a,e){if(b.length<e.length){var f=e.replace(/./g,"0");return(f+b).slice(-f.length)}return b})},loadPage:function(a){"number"===typeof a&&(a=this.pages[a]);
if(a&&!a.loaded&&!a.loading&&(a.src||a.image||a.cached||this.pdfDoc)){if(a.cached)return this.finishPageLoading(a,a.cache);a.loading=!0;var b=this;if(a.src)a.otherHalf&&a.otherHalf.loading||d.get(a.src,function(c){b.finishPageLoading(a,c);a.otherHalf&&b.finishPageLoading(a.otherHalf,c)});else if(a.image){var c=new Image;c.onload=function(){b.finishPageLoading(a,this)};d(c).addClass("wowbook-lazy");c.src=a.image}else this.pdfDoc&&b.pdfLoadPage(a.pageIndex)}},finishPageLoading:function(a,b){a.loading=
!1;a.loaded=!0;var c=!a.cached;a.cached=!1;a.removeClass("wowbook-loading");var e=a.find(".wowbook-page-content");c&&(a.image||a.src)&&this.isDoublePage(e.children().first())&&(e=e.children().first());e.append(b);this.upsertNumberInPage(a);this.opts.gutterShadow&&this.upsertGutterShadowInPage(a);if(this.opts.onLoadPage)this.opts.onLoadPage(this,a,a.pageIndex);this.updateThumbnail(a.pageIndex)},unloadPage:function(a){"number"===typeof a&&(a=this.pages[a]);if(a&&a.loaded&&!this.isPageToKeep(a)&&(a.cache=
a.find(".wowbook-page-content").html(),a.find(".wowbook-page-content").empty(),a.cached=!0,a.loaded=!1,this.pdfDoc&&(a.cache=void 0,a.cached=!1),this.opts.onUnloadPage))this.opts.onUnloadPage(this,a,a.pageIndex)},isPageToKeep:function(a){if(!this.opts.pagesToKeep)return!1;var b=a.find(".wowbook-page-content");return a.keep||b.data("keep")||b.is(this.opts.pagesToKeep)},selectPagesToUnload:function(a){void 0==a&&(a=this.currentPage);var b=[],c=this.leftPageIndex(a);a=this.rightPageIndex(a);for(var e=
this.pageBelow(c),f=this.pageBelow(a),d=this.backPage(c),g=this.backPage(a),d=d&&d.pageIndex,g=g&&g.pageIndex,l=0,p=this.pages.length;l<p;l++){var k=this.pages[l];k.loaded&&l!=c&&l!=a&&l!=e&&l!=f&&l!=d&&l!=g&&!this.isPageToKeep(k)&&b.push(l)}return b},loadedPages:function(){for(var a=[],b=0,c=this.pages.length;b<c;b++)this.pages[b].loaded&&a.push(b);return a},unloadUnusedPages:function(a){var b=this.loadedPages();if(!(b.length<=this.opts.pagesInMemory)){b=b.length-this.opts.pagesInMemory;a=this.selectPagesToUnload(a);
for(var c=0;c<b;c++)this.unloadPage(a[c])}},removePages:function(a,b){arguments.length||(a=0,b=-1);this.holdedPage&&this.releasePage(this.holdedPage);var c=this.pages;b=(b||a)+1||c.length;var e=c.slice(a,b),f=c.slice(b);c.length=0>a?c.length+a:a;c.push.apply(c,f);for(var f=0,d=e.length;f<d;f++)e[f].remove();this.updateBook();return c.length},updateBook:function(a){this.doPageNumbering();this.findPagesType();this.positionBookShadow();var b=this.rtl&&this.closable||!this.rtl&&!this.closable,c=this.opts.pageWidth||
this.opts.pageHeight,e;this.differentPageSizes=c;for(var f=0,h=this.pages.length-1;f<=h;f++){e=this.pages[f].toggleClass("wowbook-left",b).toggleClass("wowbook-right",!b).data({pageIndex:f,holded:!1});e.pageIndex=f;e.cover=!1;e.insideCover=!1;e.isCover=c&&(0==f||f==h||this.closable&&1==f||f==h-1&&!this.otherPage(h));var g=d(".wowbook-page-content",e);e.src=this.replaceNumberHolder(g.data("src")||this.opts.srcs,f);e.image=this.replaceNumberHolder(g.data("image")||this.opts.images,f);1!=e.loaded&&(e.loaded=
!e.src&&!e.image&&!e.cached);e.loaded||e.addClass("wowbook-loading");e.onLeft=b;e.onRight=!b;b=!b;e.thickness=this.opts.pageThickness;c&&(e.thickness=e.isCover?this.opts.pageThickness:"1px")}this.setCovers();this.setPagesDimension();this.findSections();this._controls&&this._controls.pagecount&&this._controls.pagecount.text(this.pages.length);a||this.showPage(this.currentPage)},setCovers:function(){function a(a){if(0==a||a==b){var e=c.pages[a];if(e){var f=c.backPage(a);c.otherPage(a)?f||(e.cover=!1,
e.insideCover=!0):(e.cover=!0,e.insideCover=!1,f&&!f.cover&&(f.insideCover=!0))}}}var b=this.pages.length-1,c=this;a(0);a(b);c.insideCoverLeft=null;c.insideCoverRight=null;for(var e=0,f=this.pages.length-1;e<=f;e++)c.pages[e].insideCover&&(c.pages[e].onLeft?c.insideCoverLeft=c.pages[e]:c.insideCoverRight=c.pages[e])},singlePage:function(a){if(void 0!==a){(this._singlePage=!!a)?this.clipBoundaries&&(this.clipBoundaries=!1,this._restoreClipBoundaries=!0,this.clipper.css("overflow","visible"),this.clipper.children(".wowbook-inner-clipper").css("overflow",
"visible")):this._restoreClipBoundaries&&(this._restoreClipBoundaries=!1,this.clipBoundaries=!0,this.clipper.css("overflow","hidden"),this.clipper.children(".wowbook-inner-clipper").css("overflow","visible"));a=0;var b=this.pageWidth;if(this._singlePage)a=this.pageIsOnTheRight(this.currentPage)?-b:0;else if(this.centeredWhenClosed){a=!!this.leftPage(this.currentPage);var c=this.rightPage(this.currentPage);a=a&&c?0:a?b/2:-b/2}this.origin.css("left",a);this.positionBookShadow()}return this._singlePage},
doPageNumbering:function(){var a=this.opts;if(a.pageNumbers&&this.pages.length){var b=a.numberedPages,a=this.pages.length-1,c=this.pageIsOnTheLeft(a);"all"==b&&(b=[0,-1]);b||(b=this.closable?[2,c?-3:-2]:[0,-1]);var e=b[0],b=b[1];0>e&&(e=a+e+1);0>e&&(e=0);e>this.pages.length-1&&(e=a);0>b&&(b=a+b+1);0>b&&(b=0);b>this.pages.length-1&&(b=a);for(var f=this.opts.firstPageNumber,c=0;c<a;c++)delete this.pages[c].number;for(c=0;c<e;c++)d(".wowbook-page-number",this.pages[c]).remove();for(c=b+1;c<a;c++)d(".wowbook-page-number",
this.pages[c]).remove();for(c=e;c<=b;c++)this.pages[c].number=f,a=d(".wowbook-page-number",this.pages[c]),a.length||(a=d(".wowbook-page-content",this.pages[c]),a=d('<div class="wowbook-page-number"></div>').appendTo(a)),a.html(f++)}},upsertNumberInPage:function(a){"number"===typeof a&&(a=this.pages[a]);if(a.number||0===a.number){var b=d(".wowbook-page-number",a);b.length||(content=d(".wowbook-page-content",a),b=d('<div class="wowbook-page-number"></div>').appendTo(content));b.html(a.number)}},upsertGutterShadowInPage:function(a){"number"===
typeof a&&(a=this.pages[a]);a.find(".wowbook-gutter-shadow").length||(a=a.find(".wowbook-page-content"),d("<div class='wowbook-gutter-shadow'>").css("height",this.pageHeight).appendTo(a))},findPagesType:function(){var a=this.opts,b={},c,e,f;f=a.hardPages||[];var d=!0===f;if(!d)for(a.hardcovers&&(f.push(0,-1),this.closable&&f.push(1),this.otherPage(this.pages.length-1)||f.push(-2)),a=0,e=f.length;a<e;a++)c=f[a],0>c&&(c=this.pages.length+c),0<=c&&c<this.pages.length&&(b[c]=!0);for(a=this.pages.length;a--;)f=
d||b[a]||this.pages[a].hardPageSetByUser,this.pages[a].toggleClass("wowbook-hardpage",f).isHardPage=f},showPage:function(a,b){0>a&&(a=0);a>this.pages.length-1&&(a=this.pages.length-1);var c=this.leftPageIndex(a),e=this.rightPageIndex(a),f=this.pageBelow(c),h=this.pageBelow(e),g=this.pageWidth,l=this.pages.length-1,p,k;this.loadPage(c);this.loadPage(e);this.loadPage(f);this.loadPage(h);this.loadPage(this.backPage(c));this.loadPage(this.backPage(e));this.opts.pagesInMemory&&this.unloadUnusedPages(a);
for(var u=0;u<=l;u++)p=this.pages[u].onLeft!=this.rtl?u:l-u,k=u===f||u===c||u===e||u===h?"block":"none",this.pages[u].data("zIndex",p).css({display:k,left:this.pages[u].onLeft?0:g,top:0,zIndex:p}),this.setPagePosition(this.pages[u]);this.differentPageSizes&&(null!==f&&this.insideCoverLeft.css("display","block"),null!==h&&this.insideCoverRight.css("display","block"));f=0==a||!this.closable&&1==a;l=a==l||a==this.otherPage(l);this.leftHandle.toggleClass("wowbook-disabled",!this.backPage(c));this.rightHandle.toggleClass("wowbook-disabled",
!this.backPage(e));this.toggleControl("back",f);this.toggleControl("next",l);this.toggleControl("first",f);this.toggleControl("last",l);(l=this.onShowPage)&&d.isFunction(l)&&!this.isOnPage(a)&&(this.currentPage=a,l(this,this.pages[a],a),(f=this.otherPage(a))&&l(this,this.pages[f],f));this.currentPage=a;this._controls.currentpage&&(l=this.currentPage,this.singlePage()||(l=d.isNumeric(c)?c:"",d.isNumeric(e)&&(l&&(l+="-"),l+=e)),this._controls.currentpage.text(l));this._sliding||(c=this._singlePage&&
this.pageIsOnTheRight(a)?-g:0,this.origin.css("left",c),this.origin.css("transform",""));this.centeredWhenClosed&&!this._singlePage&&(c=!!this.leftPage(a),e=this.rightPage(a),this.origin.css("left",c&&e?0:c?g/2:-g/2));this.positionBookShadow();!1!==b&&this.opts.updateBrowserURL&&this.locationHashToPage()!=a&&(this.locationHashSetTo=window.location.hash=this.pageToLocationHash(a));this.showThumbnail()},slideX:function(a,b){var c=parseFloat(this.origin.css("left")),e=a-c;this.origin.css("left",0);var f=
this;this._move=0;this._sliding=!0;d(this).animate({_move:1},{duration:this.opts.turnPageDuration,easing:"linear",complete:function(){this._sliding=!1;this.origin.css("transform","");this.origin.css("left",a);this.positionBookShadow();d.isFunction(b)&&b()},step:function(a,b){f.translate(this.origin,c+a*e);this.positionBookShadow()}})},holdPage:function(a,b,c,e,f){"number"===typeof a&&(a=this.pages[a]);if(a){var d=a.pageIndex,g=this.pages.length-1,l=!this.otherPage(g);if(!e)e=this.pageIsOnTheLeft(d)?
"l":"r";else if(!this.corners[e]||(this.pageIsOnTheLeft(d)?/r/:/l/).test(e))return;void 0===f&&(f=this.backPage(d));if(f){var p=f.pageIndex;a.data("holded_info",[b,c,e]);if(!this._singlePage&&this.centeredWhenClosed&&(0===d||0===p||l&&(p===g||d===g))){var k=0,u,C=!this.rtl,m=this.pageWidth,n,r,q,t,v,w,z,A;if(C?0===d:d===g&&l)n=-m/2,r=-m/4,q=0,t=-m/2,v=-m,w=r,z=v,A=b;if(C?d===g&&l:0===d)n=m,r=3*m/2,q=m/2,t=0,v=m,w=2*m,z=b,A=w;if(C?0===p:p===g&&l)n=m/2,r=d===(C?g:0)?m:3*m/2,q=d===(C?g:0)?m/2:0,t=-m/
2,v=n,w=2*m,z=b,A=w;if(C?p===g&&l:0===p)n=d===(C?0:g)?0:-m/2,r=m/2,q=m/2,t=d===(C?0:g)?-m/2:0,v=-m,w=r,z=v,A=b;b<n&&(k=q,u=z);b>r&&(k=t,u=A);b>=n&&b<=r&&(b=(b-n)/(r-n),k=q+b*(t-q),u=v+b*(w-v));b=u;this.origin.css("left",k);this.positionBookShadow()}this.zoomed||"basic"==this.pageType(a)||"basic"==this.pageType(f)?this.foldPageBasic(a,b,c,e,f):a.isHardPage||f.isHardPage?this.holdHardpage(a,b,c,e,f):this.foldPage(a,b,c,e,f);if(!a.data("holded")&&(a.addClass("wowbook-page-holded"),f.addClass("wowbook-page-holded"),
a.data("holded",!0),this.holdedPage=a,this.holdedPageBack=f,this.shadows&&this.shadowClipper.css("display","block"),this.clipBoundaries&&this.clipper.css("overflow","visible"),this.positionBookShadow(),this.opts.onHoldPage))this.opts.onHoldPage(this,d,a,f)}}},foldPage:function(a,b,c,e,f){this._currentFlip||(this._currentFlip=this.foldPageStart(a,b,c,e,f));this._currentFlip.page==a&&(this._currentFlip.x=b,this._currentFlip.y=c,this._currentFlip.page.data("holdedAt",{x:b,y:c}),this._currentFlip.corner=
e,this.foldPageStyles(this._currentFlip))},foldPageStart:function(a,b,c,e,f){var d={};"number"===typeof a&&(a=this.pages[a]);d.book=this;d.page=a;d.pageIndex=a.data("pageIndex");void 0===f&&(f=this.backPage(d.pageIndex));if(f&&f.length){d.back=f;d.pageContent=a.children().first();d.backContent=f.children().first();var g=d.page.pageWidth,l=d.page.pageHeight;e||(e="tl");if("l"==e||"r"==e){var p={x:"l"==e?0:g,y:c};a.data("grabPoint",p);d.grabPoint=p;e=(c>=p.y?"t":"b")+e}d.page.data("holdedAt",{x:b,y:c});
d.x=b;d.y=c;d.page.data("holdedCorner",e);d.corner=e;d.pageDiagonal=Math.sqrt(g*g+l*l);b=Math.ceil(d.pageDiagonal);b="rect(-"+b+"px "+b+"px "+b+"px 0px)";d.page.css("clip",b);d.pageLeft=parseFloat(a.css("left"));f.css({left:d.pageLeft+"px",zIndex:1E5,clip:b});d.shadowHeight=2*Math.ceil(d.pageDiagonal);d.shadowTop=-(d.shadowHeight-l)/2;this.shadowClipper.css({top:d.page.top,left:a.onLeft?a.left:f.left,width:2*g,height:l});this.internalShadow.css({display:"block",height:d.shadowHeight});d.foldShadowWidth=
this.foldShadow.width();this.foldShadow.css({display:"block",height:d.shadowHeight});this.foldGradientContainer.appendTo(d.backContent);d.foldGradientWidth=this.foldGradientElem.width();d.foldGradientHeight=2*Math.ceil(d.pageDiagonal);this.foldGradientElem.css("height",d.foldGradientHeight);this.foldGradientContainer.css({position:"absolute",width:d.foldGradientWidth,height:d.foldGradientHeight,top:0,left:0,display:"none"});d.foldGradientVisible=!1;return d}},foldPageStyles:function(a){var b=a.page.pageWidth,
c=a.page.pageHeight,e=b/2,f=c/2,h=d.wowBook.utils.translate,g=a.x,l=a.y,p=a.back,m=a.corner||"tl";if("l"==m||"r"==m){var u=a.page.data("grabPoint");u||(u={x:"l"==m?0:b,y:l},page.data("grabPoint",u));m=(l>=u.y?"t":"b")+(this.pageIsOnTheLeft(a.pageIndex)?"l":"r");a.corner=m;a.page.data("holdedCorner",m);var k=g-u.x,n=l-u.y,k=Math.atan2(n,k),u={x:0,y:(l>=u.y?0:c)-u.y},u=v(u,2*k),g=u.x+g,l=u.y+l}a.page.data("holdedAt",{x:g,y:l});a.page.data("holdedCorner",m);var u=a.page.corners[m],m=b-u[0],r=u[1],k=
g-m,n=l-r,q=Math.sqrt(k*k+n*n);q>b&&(g=m+b*k/q,l=r+b*n/q);var r=c-r,k=g-m,n=l-r,q=Math.sqrt(k*k+n*n),t=a.pageDiagonal;q>t&&(g=m+t*k/q,l=r+t*n/q);m=u[0];u=u[1];u==l&&(l=u+.001);k=g-m;n=l-u;q=Math.sqrt(k*k+n*n);g=q/2;k=Math.atan2(n,k);n=Math.tan(k);l=k;k=180*k/Math.PI;r={x:m-e,y:f-u};t=v(r,l);q=t.x+g+e+.5;a.pageContent.css("transform",h(-q,0)+" rotate("+(-k).toFixed(7)+"deg)");a.page.css("transform",h((Math.cos(l)*q).toFixed(5),(Math.sin(l)*q).toFixed(5))+" rotate("+k.toFixed(7)+"deg)");t=this.calculateOpacity(g,
b,this.shadowThreshold,50);if(this.shadows&&0<t){var w=a.shadowTop;this.internalShadow.css({transform:h(q+(a.page.onRight?a.page.pageWidth:0),w)+" rotate("+k+"deg)",transformOrigin:e-q+"px "+(f+(a.shadowHeight-c)/2)+"px"});q-=a.foldShadowWidth;this.foldShadow.css({transform:h(q+(a.page.onRight?a.page.pageWidth:0),w)+" rotate("+k+"deg)",transformOrigin:e-q+"px "+(f+(a.shadowHeight-c)/2)+"px"});this.shadowContainer.css({opacity:t,display:"block"})}else this.shadowContainer.css("display","none");p.show();
r.x=-r.x;t=v(r,-l);q=t.x-g+e-1;c={x:t.x-g,y:t.y+g*n};p={x:t.x-g,y:t.y-g/(0==n?1E-4:n)};c=v(c,-l);p=v(p,-l);p=-(p.x+e);c=-(c.y-f);a.backContent.css("transform",h(-q,0)+" rotate("+k+"deg)");a.back.css("transform",h((m+p+Math.cos(l)*q).toFixed(5),(u-c+Math.sin(l)*q).toFixed(5))+" rotate("+k+"deg)");t=this.calculateOpacity(2*g,2*b,this.foldGradientThreshold,50);this.foldGradient&&0<t?(this.foldGradientContainer.css({opacity:t,display:"block",transform:h(b-m-a.foldGradientWidth/2,u-a.foldGradientHeight/
2)+" rotate("+-k+"deg)"}),this.foldGradientElem.css("transform",h(-g+a.foldGradientWidth/2,0)),a.foldGradientVisible||(this.foldGradientContainer.css("display","block"),a.foldGradientVisible=!0)):a.foldGradientVisible&&(this.foldGradientContainer.css("display","none"),a.foldGradientVisible=!1)},holdHardpage:function(a,b,c,e,d){this._currentFlip||(this._currentFlip=this.flipHardPageStart(a,b,c,e,d));this._currentFlip.page==a&&(this._currentFlip.x=b,this._currentFlip.y=c,this._currentFlip.page.data("holdedAt",
{x:b,y:c}),this._currentFlip.corner=e,this.flipHardPageStyles(this._currentFlip))},flipHardPageStart:function(a,b,c,e,f){this.clipBoundaries&&this.clipper.children(".wowbook-inner-clipper").css("overflow","visible");!this.border3D&&this.opts.pageThickness&&this.opts.use3d&&Modernizr.csstransforms3d&&(this.border3D=d('<div class="wowbook-3d-border">'),this.border3D.css("background",this.opts.pageEdgeColor));this.opts.hardPageShadow&&!this.hardPageShadow&&(this.hardPageShadow=d('<div class="wowbook-hard-page-shadow">'));
var h={};"number"===typeof a&&(a=this.pages[a]);h.book=this;h.page=a;h.pageIndex=a.data("pageIndex");void 0===f&&(f=this.backPage(h.pageIndex));if(f&&f.length){h.back=f;var g=a.pageWidth;e||(e="tl");a.data("holdedAt",{x:b,y:c});a.data("holdedCorner",e);a.css("zIndex",1E5);f.css("zIndex",1E5);this.opts.use3d&&Modernizr.csstransforms3d&&(a.css(Modernizr.prefixed("perspectiveOrigin"),"0 50%"),f.css(Modernizr.prefixed("perspectiveOrigin"),"0 50%"));b=a.onLeft?g:0;a.css("transformOrigin",b+"px 50%");f.css("transformOrigin",
g-b+"px 50%");this.border3D&&this.border3D.css("width",a.thickness);this.shadows&&this.hardPageDropShadow.css({display:"block",width:a.pageWidth,height:a.pageHeight,top:a.top});return h}},flipHardPageStyles:function(a){var b=a.page,c=a.back,e=a.x,f=a.y,h=this.pageIsOnTheRight(a.pageIndex),g=this.pageWidth,l=this.pageHeight;(a=a.corner)||(a="tl");b.data("holdedAt",{x:e,y:f});b.data("holdedCorner",a);f=h?g-e:e;a=h?0:g;var p;0>f&&(f=0);f=(p=f<g)?b:c;(p?c:b).css("display","none");h=h!=p;a=e-a;a>g&&(a=
g);a<-g&&(a=-g);var k=-Math.sqrt(1600*(1-a*a/((g+15)*(g+15))));p=Math.abs(a/g);k=1==p?0:Math.atan2(k,a);if(this.opts.use3d&&Modernizr.csstransforms3d){var m;m=h?-this._calculateAngleFromX(-a,g):this._calculateAngleFromX(a,g);if(this.animating){var n=this._animationData;if(this.curledPage||n.curled)n.curled=!0,n.angle||(k={from:m,to:0},n.angle=k,m=a+n.dx,k.to=h?-this._calculateAngleFromX(-m,g):this._calculateAngleFromX(m,g),Math.abs(a)==g&&(k.from=0),Math.abs(m)==g&&(k.to=0),k.delta=k.to-k.from),m=
n.angle.from-n.angle.delta*(n.from.x-e)/n.dx}f.append(this.border3D);this.hardPageShadow&&(f.append(this.hardPageShadow),this.hardPageShadow.css("opacity",1-p));f.css({transform:"perspective("+this.opts.perspective+this.perspectiveUnit+") rotate3d(0, 1, 0, "+m+"deg)",display:"block"})}else f.css({transform:"skewY("+k+"rad) scaleX("+p+")",display:"block"});!d.wowBook.support.transform&&d.wowBook.support.filters&&(f.css("filter","progid:DXImageTransform.Microsoft.Matrix("+("M11="+p+", M12=0, M21="+
Math.tan(k)*p+", M22=1")+", sizingMethod='auto expand')"),f.css({marginTop:l-f.height(),marginLeft:h?g-f.width():0}));this.shadows&&this.hardPageDropShadow.css({left:h?b.onLeft?b.left:c.left:g,opacity:Math.abs(a)<g/2?0:(Math.abs(a)-g/2)/g*.8})},_calculateAngleFromX:function(a,b,c){var e=2*b/3;if(a>e){var d=this._calculateAngleFromX(e,b,c);return d+(a-e)/(b-e)*(0-d)}c=c||this.opts.perspective;e=180/Math.PI;d=b*b;c*=c;var h=a*a;a=Math.acos((b*c*a-Math.sqrt(d*d*c*h+d*d*h*h-d*c*h*h))/(d*c+d*h));return a=
-a*e},foldPageBasic:function(a,b,c,e,d){this._currentFlip||(this._currentFlip=this.foldPageBasicStart(a,b,c,e,d));this._currentFlip&&this._currentFlip.page==a&&(this._currentFlip.x=b,this._currentFlip.y=c,this._currentFlip.page.data("holdedAt",{x:b,y:c}),this._currentFlip.corner=e,this.foldPageBasicStyles(this._currentFlip))},foldPageBasicStart:function(a,b,c,e,d){var h={};"number"===typeof a&&(a=this.pages[a]);h.book=this;h.page=a;h.pageIndex=a.data("pageIndex");void 0===d&&(d=this.backPage(h.pageIndex));
if(d&&d.length){h.back=d;var g=a.pageHeight;e||(e="tl");a.data("holdedAt",{x:b,y:c});a.data("holdedCorner",e);d.css("zIndex",1E5);a.data("foldPageBasic",!0);h.foldGradientWidth=this.foldGradientElem.width();h.foldShadowWidth=this.foldShadow.width();this.internalShadow.css("display","none");this.foldShadow.css({display:"none",height:g,transform:"",top:a.top}).toggleClass("wowbook-shadow-fold-flipped",a.onRight);this.shadowContainer.css("display","block");b=d.children().first();this.foldGradientContainer.appendTo(b).css({width:h.foldGradientWidth,
height:g,top:0,transform:"",zIndex:1E9});this.foldGradientElem.css({left:0,height:g}).toggleClass("wowbook-fold-gradient-flipped",a.onRight);return h}},foldPageBasicStyles:function(a){var b=a.page,c=a.back;x=a.x;y=a.y;var e=b.pageWidth,d=b.pageHeight,h=a.corner;h||(h="tl");b.data("holdedAt",{x:x,y:y});b.data("holdedCorner",h);var g=(h=this.pageIsOnTheLeft(a.pageIndex))?x:e-x;0>g&&(g=0);g>2*e&&(g=2*e);var l=g/2,p;h?(p="rect(-1000px 1000px "+d+"px "+l+"px)",d="rect(-1000px 1000px "+d+"px "+(e-l)+"px)",
g=b.left+(g-e)):(p="rect(-1000px "+(e-l)+"px "+d+"px -1000px)",d="rect(-1000px "+l+"px "+d+"px -1000px)",g=c.left+(e-g+e));b.css("clip",p);c.css({clip:d,left:g,display:"block"});p=this.calculateOpacity(2*l,2*e,this.shadowThreshold,50);this.shadows&&0<p?(b=h?b.left+l-a.foldShadowWidth:c.left+e-l+e,this.shadowContainer.css("opacity",p),this.foldShadow.css({left:b,display:"block"})):this.foldShadow.css("display","none");p=this.calculateOpacity(2*l,2*e,this.foldGradientThreshold,50);this.foldGradient&&
0<p?(b=h?e-l:l-a.foldGradientWidth,this.foldGradientContainer.css({opacity:p,left:b,display:"block"})):this.foldGradientContainer.css("display","none")},stopAnimation:function(a){arguments.length||(a=!0);d(this).stop(!0,a);this.animating=!1;this.currentFlip&&(this.currentFlip.finished=!0)},flip:function(a,b,c,e){e||(e=d.isPlainObject(a)?a:{});e.from||(e.from=[]);e.to||(e.to=[]);var f=this;if(!f.animating){f.animating=!0;c||(c=e.page||f.holdedPage);var h=c.data("holded_info");c.data("holdedAt");var g=
e.corner||c.data("holdedCorner"),l=d.easing[e.easing]||e.easing||function(a){return 1==a?1:-Math.pow(2,-10*a)+1};a={page:c,back:e.back||f.holdedPageBack||f.backPage(c.pageIndex),initialX:void 0!=e.from[0]?e.from[0]:h[0],initialY:void 0!=e.from[1]?e.from[1]:h[1],finalX:void 0!=e.to[0]?e.to[0]:a,finalY:void 0!=e.to[1]?e.to[1]:b,corner:g||h[2],duration:e.duration,complete:function(){f.animating=!1;d.isFunction(e.complete)&&e.complete()},easing:l,arc:e.arc,dragging:e.dragging,start:d.now(),finished:!1};
a.deltaX=a.finalX-a.initialX;a.deltaY=a.finalY-a.initialY;this._animationData={from:{x:a.initialX,y:a.initialY},to:{x:a.finalX,y:a.finalY},dx:a.deltaX};void 0==a.duration&&(a.duration=this.turnPageDuration*Math.abs(a.deltaX)/(2*this.pageWidth));a.duration<this.opts.turnPageDurationMin&&(a.duration=this.opts.turnPageDurationMin);!c.isHardPage&&.4<a.duration/this.turnPageDuration&&this.playFlipSound();this.currentFlip=a}},rafCallback:function(){window.raf(this.callRAFCallback);this._zoomUpdateOnRAF();
if(this.currentFlip&&!this.currentFlip.finished){var a=this.currentFlip,b=(d.now()-a.start)/a.duration;1<=b&&(b=1);a.x=a.initialX+a.deltaX*a.easing(b,a.duration*b,0,1,a.duration);a.y=a.initialY+a.deltaY*a.easing(b,a.duration*b,0,1,a.duration);a.arc&&(a.y-=(.5-Math.abs(.5-a.easing(b,a.duration*b,0,1)))*this.pageHeight/10);a.dragging&&(a.x=a.initialX+.2*a.deltaX,a.y=a.initialY+.2*a.deltaY,a.initialX=a.x,a.initialY=a.y,a.deltaX=a.finalX-a.initialX,a.deltaY=a.finalY-a.initialY,1>a.deltaX&&1>a.deltaY&&
1==b);this.holdPage(a.page,a.x,a.y,a.corner,a.back);1==b&&(a.finished=!0,a.complete&&a.complete())}},releasePages:function(){for(var a=0,b=this.pages.length;a<b;a++)this.pages[a].data("holded")&&this.releasePage(a)},releasePage:function(a,b,c,e){"number"===typeof a&&(a=this.pages[a]);var d=this,h=a.data("holdedAt"),g=a.data("holdedCorner");if(b&&h)this.flip({from:[h.x,h.y],to:a.corners[g],page:a,easing:"linear",duration:1E4,duration:e,complete:function(){d.releasePage(a)}});else if(b=a.data("pageIndex"),
void 0===c&&(c=this.holdedPageBack||this.backPage(b)),this.holdedPageBack=this.holdedPage=null,a.data({holded_info:null,holdedAt:null,holdedCorner:null,grabPoint:!1,foldPageBasic:null,holded:!1}),this.clipBoundaries&&!this.zoomed&&(this.clipper.css("overflow","hidden"),this.clipper.children(".wowbook-inner-clipper").css("overflow","hidden")),this.shadowClipper.css("display","none"),this.internalShadow.parent().hide(),this.foldGradientContainer.hide(),this.hardPageDropShadow.hide(),this.resetPage(a),
c&&c.length&&(this.resetPage(c),c.hide()),this.foldShadow.removeClass("wowbook-shadow-fold-flipped").css({transform:"",left:""}),this.foldGradientElem.removeClass("wowbook-fold-gradient-flipped").css("transform",""),this.foldGradientContainer.css("transform","").appendTo(this.pagesContainer),this.positionBookShadow(),this.opts.onReleasePage)this.opts.onReleasePage(this,b,a,c)},resetPage:function(a){this._currentFlip=void 0;a.removeClass("wowbook-page-holded");this.resetCSS||(this.resetCSS={transform:"",
transformOrigin:"",clip:"auto",marginLeft:0,marginTop:0,filter:""});var b=a.pageWidth,c=a.pageHeight;a.css(this.resetCSS).css({zIndex:a.data("zIndex"),width:b,height:c,left:a.onLeft?0:this.pageWidth});this.setPagePosition(a);d.browser.msie&&9>d.browser.version&&a.attr("style",a.attr("style").replace(/clip\: [^;]+;/i,""));a=d(".wowbook-page-content",a);a.css(this.resetCSS);m(a,b,c);this.hardPageShadow&&this.hardPageShadow.hide()},gotoPage:function(a,b){var c,e;if(!this.animating){"string"===typeof a&&
"#"==a.charAt(0)&&(a=this.selectorToPage(a));0>a&&(a=0);a>this.pages.length-1&&(a=this.pages.length-1);if(this._singlePage){if(a==this.currentPage)return}else if(this.isOnPage(a))return;if(!this.elem.is(":visible"))return this.showPage(a,b),a;this._cantStopAnimation=!0;var d=a<this.currentPage;c=this.rtl?a>this.currentPage:d;var h=this,g=c?h.leftPage():h.rightPage();if(g){this.uncurl(!0);var l,p;c?(l=this.leftPage(a),p=this.rightPage(a)):(l=this.rightPage(a),p=this.leftPage(a));if(this.closable&&
this.differentPageSizes&&g.isCover!=p.isCover){if(0==g.pageIndex||0==p.pageIndex)this.showPage(1,!1);else{var k=this.pages.length-1;this.otherPage(k)||g.pageIndex!=k&&p.pageIndex!=k||this.showPage(this.backPage(k).pageIndex,!1)}this.gotoPage(p.pageIndex)}else{var m=p&&p.is(":visible");if(d)for(d=g.pageIndex-1;0<=d;d--)this.pages[d].css("display","none");else for(d=g.pageIndex+1,e=this.pages.length;d<e;d++)this.pages[d].css("display","none");l&&(l.css("display","block"),l.onLeft?this.insideCoverLeft.css("display",
"block"):this.insideCoverRight.css("display","block"));m&&p.css("display","block");var n=a;l=g.data("holdedAt");m=g.data("holdedAt");d=g.data("holdedCorner")||(c?"tl":"tr");c?(m=m||{x:0,y:0},c=2*h.pageWidth,e="bl"!=d?0:g.pageHeight):(m=m||{x:g.pageWidth,y:0},c=-g.pageWidth,e="br"!=d?0:g.pageHeight);var q="linear";if(this.centeredWhenClosed&&!this._singlePage&&(g.isHardPage||p.isHardPage)){var k=this.pages.length-1,r=!this.rtl,q="easeOutCubic";this.pageIsOnTheRight(this.currentPage)&&!this.otherPage(this.currentPage)&&
(c+=this.pageWidth/2,a!=(r?k:0)||this.otherPage(a)||(c+=this.pageWidth/2));this.pageIsOnTheLeft(this.currentPage)&&!this.otherPage(this.currentPage)&&(c-=this.pageWidth/2,a!=(r?0:k)||this.otherPage(a)||(c-=this.pageWidth/2))}if(this._singlePage){if(this.isOnPage(a))return this.animating=!0,this.slideX(this.pageIsOnTheLeft(a)?0:-this.pageWidth,function(){h._cantStopAnimation=!1;h.animating=!1;h.showPage(n,b)}),a;this.slideX(this.pageIsOnTheLeft(a)?0:-this.pageWidth,function(){h.showPage(n,b)})}h.flip({from:[m.x,
m.y],to:[c,e],easing:q,arc:!l,page:g,back:p,corner:d,complete:function(){h._cantStopAnimation=!1;h.releasePage(g,!1);h.showPage(n,b)}});return a}}}},back:function(){return this.gotoPage(this.currentPage-(this._singlePage?1:2))},advance:function(){return this.gotoPage(this.currentPage+(this._singlePage?1:2))},leftPage:function(a){void 0===a&&(a=this.currentPage);return this.pages[this.leftPageIndex(a)]||null},leftPageIndex:function(a){if(null!=a){this.pageIsOnTheRight(a)&&(a+=this.rtl?1:-1);if(0>a||
a>this.pages.length-1)a=null;return a}},rightPage:function(a){void 0===a&&(a=this.currentPage);return this.pages[this.rightPageIndex(a)]||null},rightPageIndex:function(a){if(null!=a){this.pageIsOnTheLeft(a)&&(a+=this.rtl?-1:1);if(0>a||a>this.pages.length-1)a=null;return a}},pageIsOnTheRight:function(a){return!this.pageIsOnTheLeft(a)},pageIsOnTheLeft:function(a){a=!(a%2);this.closable&&(a=!a);this.rtl&&(a=!a);return a},otherPage:function(a){var b=this.pageIsOnTheLeft(a)?1:-1;this.rtl&&(b=-b);a+=b;
if(0>a||a>this.pages.length-1)a=null;return a},isOnPage:function(a){return"number"===typeof a&&(a===this.currentPage||a===this.otherPage(this.currentPage))},backPage:function(a){if(!this.pages[a])return null;var b=a%2?1:-1;a+=this.closable?-b:b;return this.pages[a]},pageBelow:function(a){a=parseInt(a,10);if(a!=a)return null;a+=this.pageIsOnTheLeft(a)!=this.rtl?-2:2;if(0>a||a>this.pages.length-1)a=null;return a},pageType:function(a){a="number"===typeof a?this.pages[a]:a;return a.isHardPage?"hard":
a.find(".wowbook-page-content.wowbook-basic-page").length?"basic":"soft"},calculateOpacity:function(a,b,c,e){if(a<=c||a>=b-c)return 0;if(a>=e&&a<=b-e)return 1;a>e&&(a=b-a);return(a-c)/(e-c)},startSlideShow:function(){this.slideShowRunning=!0;this.advanceAfterTimeout(this.slideShowDelay);this.toggleControl("slideshow",!0)},advanceAfterTimeout:function(a){var b=this;this.slideShowTimer=setTimeout(function(){if(b.animating||b.holdedPage)b.advanceAfterTimeout(100);else{var a=b.isOnPage(b.pages.length-
1);b.opts.slideShowLoop&&a?b.gotoPage(0):b.advance();b.opts.slideShowLoop||!a?b.advanceAfterTimeout(b.slideShowDelay+b.turnPageDuration):b.stopSlideShow()}},a)},stopSlideShow:function(a){clearTimeout(this.slideShowTimer);this.slideShowTimer=void 0;this.slideShowRunning=!1;a||this.toggleControl("slideshow",!1)},toggleSlideShow:function(){this.slideShowRunning?this.stopSlideShow():this.startSlideShow()},findSections:function(a){a&&(this.sectionDefinition=a);var b=this.sectionDefinition;a=[];var c;"string"===
typeof b&&(c=b,b=[],d(c,this.elem).each(function(a,c){b.push(["#"+c.id,d(c).html()])}));if(d.isArray(b)){for(var e=0,f=b.length;e<f;e++){c=b[e];if("string"===typeof c)try{c=[c,d(c,this.elem).html()]}catch(h){continue}try{c[2]=this.selectorToPage(c[0])}catch(h){continue}void 0!==c[2]&&a.push({id:c[0],title:c[1],page:c[2]})}a=a.sort(function(a,b){return a.page-b.page})}return this.sections=a},pageToSection:function(a){for(var b=this.sections,c,e=0,d=b.length;e<d&&!(b[e].page>a);e++)c=b[e];return c},
currentSection:function(){return this.pageToSection(this.currentPage)},fillToc:function(a,b){var c=d(a||this.opts.toc),e,f,h="";if(0!==c.length){e=this.sections;"undefined"===typeof b&&(b=this.opts.tocTemplate);b||(h=c.is("UL, OL")?"<li>":"<div>",b='<a href="${link}">${section}</a>');for(var g=0,l=e.length;g<l;g++)f=e[g],f=b.replace(/\$\{link\}/g,"#"+this.id+"/"+f.id.substr(1)).replace(/\$\{section\}/g,f.title).replace(/\$\{page\}/g,f.page),d(f).appendTo(c).wrap(h)}},createToc:function(a){a=this.opts.toc||
a||[];var b=this.tocContainer=d("<div class='wowbook-toc' style='display:none'>").prependTo(d(this.opts.tocParent||"body"));b.append("<h1>"+this.opts.tocHeader+"<button class='wowbook-close'>&#10005;</button></h1>");this.controllify({toc:b.find(".wowbook-close")});for(var b=d("<ul class='wowbook-toc-items'>").appendTo(b),c=0,e=a.length;c<e;c++)this.createTocItem(a[c][0],a[c][1]).appendTo(b)},createTocItem:function(a,b){var c=this.opts.tocItemTemplate||'<li class="wowbook-toc-item"><a href="${link}">${title}<span class="page">${page}</span></a></li>',
e="";d.isNumeric(b)&&(e=b,b=this.pageToLocationHash(b));c=c.replace(/\$\{link\}/g,b).replace(/\$\{title\}/g,a).replace(/\$\{page\}/g,e);return d(c)},destroyToc:function(){this.tocContainer&&this.tocContainer.remove();this.tocContainer=null},showToc:function(a){this.tocContainer&&this.tocContainer.length||this.createToc();this.tocContainer.fadeIn(a)},hideToc:function(a){this.tocContainer.fadeOut(a)},toggleToc:function(a){d(this.tocContainer).is(":visible")?this.hideToc(a):this.showToc(a)},locationHashToPage:function(a,
b){void 0===a&&(a=window.location.hash);if(a=="#"+this.id+"/")return 0;a=a.slice(1).split("/");if(a[0]===this.id){if(1===a.length)return 0;var c=parseInt(a[1]);if(!isNaN(c))return Math.max(c-1,0);c=this.selectorToPage("#"+a[1]);if(void 0===c)return 0;isNaN(a[2])||(c+=Math.max(parseInt(a[2])-1,0));return+c}},pageToLocationHash:function(a){var b="",c=a+1;if(a=this.pageToSection(a))b+="/"+a.id.replace("#",""),c-=a.page;1<c&&(b+="/"+c);return"#"+this.id+(b||"/")},selectorToPage:function(a){a=d(a,this.elem).closest(".wowbook-page");
if(a.length)return+a.data("pageIndex")},getLocationHash:function(){return window.location.hash.slice(1)},locationEndsInHash:function(a){void 0===a&&(a=window.location.href);return a.lastIndexOf("#")==a.length-1},zoomSetup:function(){this._zoomOffset={dx:0,dy:0};this._cssZoom=this._cssZoom||1;this.zoomLevel=1;this.detectBestZoomMethod();this.zoomTouchSupport();this.toggleControl("zoomIn",this.zoomLevel==this.zoomMax);this.toggleControl("zoomOut",this.zoomLevel==this.zoomMin);this.toggleControl("zoomReset",
1==this.zoomLevel)},_zoomUpdateOnRAF:function(){if(this._zoomDataRAF){var a=d.extend({},this._zoomDataRAF.options),b=this._zoomDataRAF.options.offset;if(b){var c=this._zoomOffset,e=b.dx-c.dx,f=b.dy-c.dy;a.offset={dx:c.dx+.2*e,dy:c.dy+.2*f}}c=this._zoomDataRAF.level||this.zoomLevel;c!=this.zoomLevel&&(c=this.zoomLevel+.2*(c-this.zoomLevel));a.transform=!0;this._zoom(c,a);b&&1>Math.abs(e)&&1>Math.abs(f)&&1>Math.abs(this.zoomLevel-c)&&(this._zoomDataRAF.callback&&this._zoomDataRAF.callback.call(this),
this._zoomDataRAF=null)}},_zoom:function(a,b){b||(b={});var c=void 0!=b.x?b.x:this.pageWidth*this.currentScale,e=b.y||0;this._zoomOffset=b.offset||this.zoomFocusOffset(a,c,e);this.zoomLevel=a;var c=b.transform||this.opts.zoomUsingTransform,f=a*this.currentScale,e=d.browser.ie7?1:c?this._cssZoom:f,h=this.zoomWindow,g=this.zoomContent,l=d(this.zoomBoundingBox),k=l.outerWidth(),m=l.outerHeight(),n=h.offset();h.position();l=l[0]!==window?l.offset():{left:l.scrollLeft(),top:l.scrollTop()};h.css({width:k,
height:m});k=l.left-n.left;n=l.top-n.top;k&&(k+=parseFloat(h.css("marginLeft")),h.css("marginLeft",k),g.marginLeft=k);n&&(n+=parseFloat(h.css("marginTop")),h.css("marginTop",n),g.marginTop=n);h="";n=this._zoomOffset.dx/e;k=this._zoomOffset.dy/e;d.wowBook.support.transform&&(n||k)?h=d.wowBook.utils.translate(n,k):g.css({left:n,top:k});c?(f/=e,h+=this.opts.useScale3d?"scale3d("+f+","+f+",1)":"scale("+f+")"):(this._cssZoom=f,g.css("zoom",f),g.css("marginLeft",-g.marginLeft/e),g.css("marginTop",-g.marginTop/
e));d.wowBook.support.transform&&g.css("transform",h);1!==this.zoomLevel?this.zoomed||(g.css("marginLeft",-g.marginLeft/e),g.css("marginTop",-g.marginTop/e),c&&g.css("transformOrigin","0 0"),this.elem.find("img").each(function(){var a=d(this);a.data("wowbook-draggable-before-zoom",a.attr("draggable"));a.attr("draggable",!1)})):this.zoomFinished();this.zoomed=1!==a;g.toggleClass("wowbook-draggable",this.zoomed);this.toggleControl("zoomIn",this.zoomLevel==this.zoomMax);this.toggleControl("zoomOut",
this.zoomLevel==this.zoomMin);this.toggleControl("zoomReset",1==this.zoomLevel)},zoom:function(a,b,c){this.uncurl(!0);for(var e=0,f=this.pages.length;e<f;e++)if(this.pages[e].data("holdedAt"))return;d.isPlainObject(b)&&(c=b,b=c.duration);c||(c={});if(a<=this.zoomMin&&!c.resetting)return this.zoomReset(b,c);a>this.zoomMax&&(a=this.zoomMax);if(a!==this.zoomLevel||c.force)if(void 0==b&&(b=this.opts.zoomDuration),0==b){if(this._zoom(a,c),c.callback&&c.callback.apply(this),this.onZoom)this.onZoom(this)}else{e=
!this.opts.zoomUsingTransform&&d.wowBook.support.transform;this._zoomAnimating&&(d(this).stop(),e&&this.zoomContent.css("transform",""));this._zoomAnimating=this.zoomLevel;var h=this,f=c.x,g=c.y||0;void 0==f&&(f=(this._singlePage?this.pageWidth/2:this.pageWidth)*this.currentScale);var l={x:f,y:g,offset:{dx:0,dy:0}},k=d.extend({dx:0,dy:0},this._zoomOffset),f=c.offset||this.zoomFocusOffset(a,f,g),m=f.dx-k.dx,n=f.dy-k.dy;e&&(l.transform=!0,this._isMobile&&(this.leftPage()&&this.leftPage().css("-webkit-transform",
"translateZ(0)"),this.rightPage()&&this.rightPage().css("-webkit-transform","translateZ(0)")));d(this).animate({_zoomAnimating:a},{duration:b,easing:c.easing||this.opts.zoomEasing,complete:function(){h._zoomAnimating=!1;h._zoom(a);c.callback&&c.callback.apply(this);if(h.onZoom)h.onZoom(h)},step:function(a,b){l.offset.dx=k.dx+m*b.pos;l.offset.dy=k.dy+n*b.pos;h._zoom(a,l)}})}},zoomFinished:function(){this.zoomWindow.css({overflow:"visible",width:this.zoomContent.width()*this.currentScale,height:this.zoomContent.height()*
this.currentScale,marginLeft:0,marginTop:0});this.zoomContent.css({left:0,top:0,marginLeft:0,marginTop:0});this._zoomOffset={dx:0,dy:0};this.elem.find("img").each(function(){var a=d(this);void 0==a.data("wowbook-draggable-before-zoom")?a.removeAttr("draggable"):a.attr("draggable",a.data("wowbook-draggable-before-zoom"))})},zoomReset:function(a,b){d.isPlainObject(a)&&(b=a,a=b.duration);b||(b={});this._zoomDataRAF=null;b.offset={dx:0,dy:0};b.resetting=!0;b.force=!0;b.callback=function(){this.zoomContent.css({left:0,
top:0});this.zoomed=!1};this.zoom(1,a,b)},zoomIn:function(a,b){d.isPlainObject(a)&&(b=a,a=void 0);this.zoom(this.zoomLevel+(a||this.zoomStep),b)},zoomOut:function(a,b){d.isPlainObject(a)&&(b=a,a=void 0);this.zoom(this.zoomLevel-(a||this.zoomStep),b)},zoomFocusOffset:function(a,b,c,e,f){e||(e=this._zoomOffset||{dx:0,dy:0});e=d.extend({dx:0,dy:0},e);var h=e.dx||0,g=e.dy||0;f=a/(f||this.zoomLevel);b-=h;c-=g;a=b*f;f*=c;e.dx=h-(a-b);e.dy=g-(f-c);return{dx:h-(a-b),dy:g-(f-c)}},zoomTouchSupport:function(){if(this.opts.touchEnabled){if(d.browser.ie8mode||
d.browser.ie7)return this.zoomDragSupportForIE();var a=this,b,c,e;a._hammer=new Hammer(a.zoomContent[0],a.opts.touch);var f=a._hammer;f.on("panstart pinchstart",function(b){a.zoomContent.addClass("wowbook-dragging")});f.on("hammer.input",function(b){if(b.isFinal&&a.zoomContent.hasClass("wowbook-dragging")){c=e=null;a.zoomContent.removeClass("wowbook-dragging");b=a.zoomLevel;var d=a._zoomDataRAF,f=d?d.level:b;f<a.zoomMin||f==a.zoomMin&&(a._zoomOffset.dx||a._zoomOffset.dy)?d?d.callback=function(){a.zoomReset()}:
a.zoomReset():a._zoom(b,{force:!0,offset:a._zoomOffset})}});f.on("panstart panmove",function(b){a.zoomed&&(b.preventDefault(),e=null,c||(c={offset:d.extend({},a._zoomOffset),pageX:b.center.x,pageY:b.center.y}),a._zoomDataRAF={level:a.zoomLevel,options:{force:!0,offset:{dx:c.offset.dx+(b.center.x-c.pageX),dy:c.offset.dy+(b.center.y-c.pageY)}}})});f.on("pinchmove pinchstart",function(f){f.preventDefault();c=null;var g=f.center.x,l=f.center.y;if(!e){if(a.currentFlip&&!a.currentFlip.finished)return;b=
a.elem.offset();e={level:a.zoomLevel,pageX:g,pageY:l,x:g-b.left,y:l-b.top,offset:d.extend({},a._zoomOffset),useTransform:a.opts.zoomUsingTransform}}f=e.level*f.scale;f>a.zoomMax&&(f=a.zoomMax);var k=a.zoomFocusOffset(f,e.x,e.y,e.offset,e.level);k.dx+=g-e.pageX;k.dy+=l-e.pageY;a._zoomDataRAF={level:f,options:{force:!0,offset:k}}});a.opts.pinchToZoom&&(f.get("pinch").set({enable:!0}),f.get("pinch").recognizeWith("pan"))}},zoomDragSupportForIE:function(){var a=this,b,c=function(c){a._zoomDataRAF={level:a.zoomLevel,
options:{force:!0,offset:{dx:b.offset.dx+(c.pageX-b.pageX),dy:b.offset.dy+(c.pageY-b.pageY)}}};return!1},e=function(b){b=a.zoomLevel;(b<a.zoomMin||b==a.zoomMin&&(a._zoomOffset.dx||a._zoomOffset.dy))&&a.zoomReset();d(document).unbind("mousemove.wowbook",c);d(document).unbind("mouseup.wowbook",e)};a.zoomContent.bind("mousedown.wowbook",function(f){if(a.zoomed)return b={offset:d.extend({},a._zoomOffset),pageX:f.pageX,pageY:f.pageY},d(document).bind("mousemove.wowbook",c).bind("mouseup.wowbook",e),!1})},
detectBestZoomMethod:function(a,b,c){void 0===a&&(a=d.wowBook.support.transform);void 0===c&&(c=d.browser.ie8mode);a=d.browser.chrome||d.browser.webkit||d.browser.safari||d.browser.opera||c||!a;this.opts.zoomUsingTransform=!a;return a?"zoom":"transform"},setupFullscreen:function(){if(w){var a=this,b,c="fullscreenerror mozfullscreenerror webkitfullscreenerror MSFullscreenError ";b="fullscreenchange mozfullscreenchange webkitfullscreenchange MSFullscreenChange ".replace(/ /g,".wowbook ");c=c.replace(/ /g,
".wowbook ");this._fullscreenChangeHandler=function(){var b=!!(n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement);d(a.opts.fullscreenElement).toggleClass("fullscreen wowbook-fullscreen-fix",b);a.elem.toggleClass("fullscreen",b);a.toggleControl("fullscreen",b)};d(document).on(b,this._fullscreenChangeHandler);this._fullscreenErrorHandler=function(){a.opts.onFullscreenError&&a.opts.onFullscreenError.apply(this,arguments)};d(document).on(c,this._fullscreenErrorHandler)}else d("html").addClass("no-fullscreen")},
enterFullscreen:function(a){a=d(a||this.opts.fullscreenElement)[0];w.call(a||z)},exitFullscreen:function(){A.call(n)},toggleFullscreen:function(){n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement?this.exitFullscreen():this.enterFullscreen()},positionBookShadow:function(){var a=this.pages.length,b=!(!this.opts.bookShadow||!a||3>a&&this.holdedPage);this.bookShadow.toggle(b);if(b){var b=this.pageWidth,c=this.holdedPageBack,e=!!c&&c.onRight&&c.pageIndex==(this.rtl?
a-1:0),c=!!c&&c.onLeft&&c.pageIndex==(this.rtl?0:a-1),a=!this.leftPage()||e,c=!this.rightPage()||c,e=a!=c;if(a&&c)this.bookShadow.hide();else{var c=this.opts.zoomUsingTransform?this.currentScale*this.zoomLevel:1,d=this.elem.is(":visible")?this.pagesContainer.position().left:parseFloat(this.pagesContainer.css("left"))||0;this.translate(this.bookShadow,(a?b:0)+d/c,0);this.bookShadow.css({width:e?b:2*b})}}},playFlipSound:function(){if(this.flipSound){var a=this.opts.onPlayFlipSound;d.isFunction(a)&&
!1===a(this)||(this.audio||(this.audio=this.createAudioPlayer()),this.audio&&this.audio.play&&this.audio.play())}},toggleFlipSound:function(a){arguments.length||(a=!this.flipSound);this.flipSound=a;this.toggleControl("flipSound",!a)},createAudioPlayer:function(a,b){a||(a=this.opts.flipSoundPath);b||(b=this.opts.flipSoundFile);for(var c=[],e=0,f=b.length;e<f;e++)c.push('<source src="'+a+b[e]+'">');return d("<audio preload>"+c.join("")+"</audio>")[0]},_untouch:function(a){return a.originalEvent.touches&&
a.originalEvent.touches[0]||a},touchSupport:function(){var a=this;a.elem.bind("touchstart.wowbook",function(b){var c=b.originalEvent.touches;1<c.length||(a._touchStarted={x:c[0].pageX,y:c[0].pageY,timestamp:b.originalEvent.timeStamp,inHandle:d(b.target).hasClass("wowbook-handle")},a._touchStarted.inHandle&&a.pageEdgeDragStart(a._untouch(b)))});d(document).on("touchmove.wowbook",function(b){if(a._touchStarted){var c=b.originalEvent.touches;a._touchEnded={x:c[0].pageX,y:c[0].pageY,timestamp:b.originalEvent.timeStamp};
if(a._touchStarted.inHandle)return a.pageEdgeDrag(a._untouch(b));a.opts.allowDragBrowserPageZoom&&1!=document.documentElement.clientWidth/window.innerWidth||b.preventDefault()}});d(document).on("touchend.wowbook touchcancel.wowbook",function(b){if(a._touchStarted){!a._touchEnded&&d(b.target).hasClass("wowbook-handle")&&(b=d(b.target).data("corner"),"r"===b&&a.advance(),"l"===b&&a.back());var c=a._touchStarted,e=a._touchEnded||a._touchStarted;a._touchStarted=null;a._touchEnded=null;if(!a.zoomed){if(c.inHandle)return a.pageEdgeDragStop({pageX:e.x}),
!1;b=e.x-c.x;var f=e.y-c.y,c=e.timestamp-c.timestamp;if(!(20>Math.abs(b)||200<c)&&Math.abs(b)>Math.abs(f))return 0>b?a.advance():a.back(),!1}}})},pageEdgeDragStart:function(a){if(!this.zoomed){if(this.animating&&!this.curledPage||!d(a.target).hasClass("wowbook-handle"))return!1;var b=this,c=b.origin.offset();this.opts.zoomUsingTransform||(c.left*=this.currentScale);b.elem.addClass("wowbook-unselectable");b.mouseDownAtLeft=(a.pageX-c.left)/this.currentScale<b.pageWidth;b.pageGrabbed=b.mouseDownAtLeft?
b.leftPage():b.rightPage();if(!b.pageGrabbed)return!1;this.uncurl(!0);b.pageGrabbedOffset=b.pageGrabbed.offset();b._dragging=!0;this.opts.zoomUsingTransform&&(b.pageGrabbedOffset.left/=this.currentScale,b.pageGrabbedOffset.top/=this.currentScale);c=a.pageX/this.currentScale-this.pageGrabbedOffset.left;a=a.pageY/this.currentScale-this.pageGrabbedOffset.top;this.stopAnimation(!1);var e=b.mouseDownAtLeft?"l":"r";this.holdPage(this.pageGrabbed,c,a);this.flip(c,a,this.pageGrabbed,{corner:e});d(document).bind("mousemove.wowbook",
function(a){return b.pageEdgeDrag(a)}).bind("mouseup.wowbook",function(a){return b.pageEdgeDragStop(a)});return!1}},pageEdgeDrag:function(a){if(!this._dragging)return!1;var b=a.pageX/this.currentScale-this.pageGrabbedOffset.left;a=a.pageY/this.currentScale-this.pageGrabbedOffset.top;var c=this.mouseDownAtLeft?"l":"r";this.stopAnimation(!1);this.flip(b,a,this.pageGrabbed,{corner:c,dragging:!0});return!1},pageEdgeDragStop:function(a){if(!this._dragging)return!1;var b=this.origin.offset();this.opts.zoomUsingTransform||
(b.left*=this.currentScale);var c=(a.pageX-b.left)/this.currentScale;a=(a.pageX-b.left)/this.currentScale<this.pageWidth;this.elem.removeClass("wowbook-unselectable");this._cantStopAnimation||this.stopAnimation(!1);this._singlePage?this.pageGrabbed.onLeft?c>this.pageWidth/2?this.rtl?this.advance():this.back():this.releasePage(this.pageGrabbed,!0):c<this.pageWidth+this.pageWidth/2?this.rtl?this.back():this.advance():this.releasePage(this.pageGrabbed,!0):this.mouseDownAtLeft&&!a?this.rtl?this.advance():
this.back():!this.mouseDownAtLeft&&a?this.rtl?this.back():this.advance():this.releasePage(this.pageGrabbed,!0);this._dragging=!1;d(document).unbind("mousemove.wowbook mouseup.wowbook")},curl:function(a,b){if(!(this.curledPage||this.holdedPage||this.zoomed)){void 0==a&&(a=this.currentPage);if("number"==typeof a||"string"==typeof a)a=this.pages[+a];if(a&&!a.isCurled){a.isCurled=!0;this.curledPage=a;var c=this.pageIsOnTheLeft(a.pageIndex),e=c?0:this.pageWidth,d=b?this.pageHeight-1:2;this.flip({from:[e,
d],to:[e+this.opts.curlSize*(c?1:-1),d+this.opts.curlSize*(b?-1:1)],corner:(b?"b":"t")+(c?"l":"r"),page:a,duration:400})}}},uncurl:function(a,b){if(this.curledPage){1==a&&(b=!0,a=void 0);void 0==a&&(a=this.curledPage||this.currentPage);if("number"==typeof a||"string"==typeof a)a=this.pages[+a];a.isCurled&&(this.stopAnimation(!1),this.releasePage(a,!b,void 0,400),a.isCurled=!1,this.curledPage=null)}},initThumbnails:function(){var a=this.opts;this.thumbnails=[];var b=this.thumbnailsContainer=d("<div class='wowbook-thumbnails'>").append("<div class='wowbook-wrapper'><div class='wowbook-back wowbook-button wowbook-control wowbook-control-back'/><div class='wowbook-clipper'><ul></ul></div><div class='wowbook-next wowbook-button wowbook-control wowbook-control-next' /></div>").css("display",
"none").css("transform","translateZ(0)").appendTo(d(a.thumbnailsParent));this.thumbnailsList=b.find("ul");this.thumbnailsClipper=b.find(".wowbook-clipper");a.thumbnailsContainerWidth&&b.width(a.thumbnailsContainerWidth);a.thumbnailsContainerHeight&&b.height(a.thumbnailsContainerHeight);var c=a.thumbnailsPosition;if("left"==c||"right"==c)a.thumbnailsVertical=!0,"right"==c&&b.css({position:"absolute",left:"auto",right:"0px"});if("top"==c||"bottom"==c)a.thumbnailsVertical=!1,"bottom"==c&&b.css({position:"absolute",
top:"auto",bottom:"0px"});b.addClass(a.thumbnailsVertical?"wowbook-vertical":"wowbook-horizontal");b.toggleClass("wowbook-closable",this.closable);var e=this,f=a.thumbnailsVertical?"height":"width";this.thumbnailsBackButton=b.find(".wowbook-back.wowbook-button").click(function(){e._moveThumbnailsList(e.thumbnailsClipper[f]())});this.thumbnailsNextButton=b.find(".wowbook-next.wowbook-button").click(function(){e._moveThumbnailsList(-e.thumbnailsClipper[f]())});this.thumbnailsClipper.css("transform",
"translateZ(0)");0==this.scrollBarWidth()&&this.thumbnailsClipper.css("overflow","auto")},destroyThumbnails:function(){this.thumbnailsContainer&&this.thumbnailsContainer.remove();this.thumbnails=this._thumbnailsPos=this.thumbnailsContainer=null},scrollBarWidth:function(){var a=d("<div style='display: inline-block;position: absolute;left:-1000px;'>Hi!</div>").appendTo("body"),b=a.width();a.css("overflow","scroll");var c=a.width();a.remove();return c-b},createThumbnails:function(){this.thumbnails||
this.initThumbnails();var a,b=this.thumbnailConfig();this.thumbnails=[];for(var c=0,e=this.pages.length;c<e;c++)a=this.createThumbnail(c,b),this.thumbnailsList.append(a),this.thumbnails.push(a);if(this.rtl)for(a=this.thumbnailsList.children(),a.eq(0).addClass("wowbook-right").removeClass("wowbook-left"),c=1,e=a.length;c<e;c+=2)a.eq(c).insertAfter(a.eq(c+1));c=this.thumbnailsContainer;c.width()||c.width(2*b.width)},thumbnailConfig:function(){var a={},b=d('<div class="wowbook-thumbnail" style="display:none;position:absolute;line-height:0px;font-size:0px;">').prependTo(this.thumbnailsContainer),
c=this.opts.thumbnailHeight||(2>=b.height()?0:b.height()),e=this.opts.thumbnailWidth||b.width(),f=e/this.pageWidth||c/this.pageHeight||this.opts.thumbnailScale;b.remove();this.thumbnailScale=f;a.width=e||Math.floor(this.pageWidth*f);a.height=c||Math.floor(this.pageHeight*f);a.cloneCSS={display:"block",left:0,top:0,position:"relative",transformOrigin:"0 0"};d.wowBook.support.transform?a.cloneCSS.transform="scale("+f+")":a.cloneCSS.zoom=f;this.differentPageSizes&&(b=this.opts.pageWidth?f*this.pageWidth/
this.opts.pageWidth:this.opts.pageHeight?f*this.pageHeight/this.opts.pageHeight:this.opts.thumbnailScale,a.scaleInternalPage=d.wowBook.support.transform?{transform:"scale("+b+")"}:{zoom:b});return a},createThumbnail:function(a,b){var c=this.pages[a];if(c){b||(b=this.thumbnailConfig());var e=d('<li class="wowbook-thumbnail"><div class="wowbook-overlay">').addClass(this.pageIsOnTheLeft(a)?"wowbook-left":"wowbook-right").css({width:b.width,height:b.height});if(this.opts.thumbnailsSprite)e.css("background",
"url("+this.opts.thumbnailsSprite+") no-repeat 0px -"+a*b.height+"px");else{var f=c.clone();f.hasClass("wowbook-page-holded")&&(this.resetPage(f),f.find(".wowbook-fold-gradient-container").remove());f.css(b.cloneCSS);b.scaleInternalPage&&!c.isCover&&f.css(b.scaleInternalPage);e.prepend(f)}var h=this;e.click(function(){h.gotoPage(a);h.hideThumbnails()});return e}},updateThumbnail:function(a,b){if(this.thumbnails){var c=this.thumbnails[a];if(c){var e=this.createThumbnail(a,b);e&&(c.width(e.width()),
c.height(e.height()),this.opts.thumbnailsSprite||(this.pdfDoc?this.pdfRenderThumbnail(a,c,b):c.children(":not(.wowbook-overlay)").replaceWith(e.children(":not(.wowbook-overlay)"))),c.width(e.width()),c.height(e.height()))}}},updateThumbnails:function(){if(this.thumbnails){for(var a=this.thumbnailConfig(),b=0,c=this.pages.length;b<c;b++)this.updateThumbnail(b,a);b=this.thumbnailsContainer;b.width()||b.width(2*a.width);this.thumbnailsContainer.toggleClass("wowbook-closable",this.closable)}else this.createThumbnails()},
_moveThumbnailsList:function(a,b){var c=this.thumbnailsList.position()[this.opts.thumbnailsVertical?"top":"left"];this._setThumbnailsListPosition(c+a,b)},_setThumbnailsListPosition:function(a,b){var c=this.opts.thumbnailsVertical,e=c?"height":"width",f=this.thumbnailsClipper[e](),e=-this.thumbnailsList[e]()+f;a<e&&(a=e);0<a&&(a=0);this.thumbnailsBackButton.toggleClass("wowbook-disabled",0==a||0<e);this.thumbnailsNextButton.toggleClass("wowbook-disabled",a==e||0<e);void 0==b&&(b=d.extend({},this.opts.thumbnailsAnimOptions));
var h=this;d.isNumeric(b)&&(b={duration:b});b.step=c?function(a){h.thumbnailsClipper.scrollTop(a)}:function(a){h.thumbnailsClipper.scrollLeft(a)};b.complete=function(){h.pdfDoc&&h.updateVisibleThumbnails()};this._tb=this.thumbnailsClipper[c?"scrollTop":"scrollLeft"]();d(this).stop();d(this).animate({_tb:-a},b)},updateVisibleThumbnails:function(){var a=this.opts.thumbnailsVertical,b=a?"top":"left",c=a?"height":"width";if(!this._thumbnailsPos)for(this._thumbnailsPos=[],a=0;a<this.thumbnails.length;a++)this._thumbnailsPos[a]=
this.thumbnails[a].position()[b];for(var e=this._thumbnailsPos,b=-this.thumbnailsList.position()[b],c=b+this.thumbnailsClipper[c](),d,h,a=0;a<this.thumbnails.length;a++)void 0==d&&e[a]>b&&(d=a),void 0==h&&e[a]>c&&(h=a);d||(d=0);h||(h=this.thumbnails.length-1);this.pdfCancelRenderThumbnail(0,d);this.pdfCancelRenderThumbnail(h,this.thumbnails.length);for(a=d-2;a<=h;a++)this.updateThumbnail(a)},showThumbnail:function(a,b){if(this.thumbnails&&this.thumbnailsContainer.is(":visible")){void 0==a&&(a=this.currentPage);
0<a&&this.pageIsOnTheRight(a)&&a--;var c=this.opts.thumbnailsVertical,e=c?"top":"left",d=c?"height":"width",h=this.thumbnails[a],g=this.thumbnailsClipper,c=g[d]()/2-h[d]()/(c?2:1),e=h.offset()[e]-g.offset()[e];this._moveThumbnailsList(c-e,b)}},showThumbnails:function(a){this.thumbnails&&this.thumbnails.length||this.createThumbnails();this.thumbnailsContainer.fadeIn(void 0!=a?a:this.opts.thumbnailsAnimOptions);this.showThumbnail(void 0,0)},hideThumbnails:function(a){this.thumbnailsContainer.fadeOut(void 0!=
a?a:this.opts.thumbnailsAnimOptions)},toggleThumbnails:function(a){d(this.thumbnailsContainer).is(":visible")?this.hideThumbnails(a):this.showThumbnails(a)},setPDF:function(a){this.pdf=a;this.pdfRenderQueue=[];this.pdfPageRendering=!1;this.elem.addClass("wowbook-pdf");this.removePages();null==this.opts.pagesInMemory&&(this.opts.pagesInMemory=6);var b=this;this.pdfCSS_UNITS=96/72;PDFJS.getDocument(a).then(function(a){b.pdfDoc=a;a.getPage(1).then(function(e){for(var d=0;d<a.numPages;d++)b.insertPage("<div>",
!0);b.updateBook();e=e.getViewport(1*b.pdfCSS_UNITS*b.opts.pdfScale);b.pdfHeight=e.height;b.pdfWidth=e.width;b._originalHeight=null;b._originalWidth=null;b.setDimensions(2*b.pdfWidth,b.pdfHeight)})},b.opts.onPDFLoadError||function(a){d(b.pages[0]||b.elem).html(a.message);console&&console.log&&console.log(a)})},pdfResetPages:function(){this.updateBook();for(var a=0;a<this.pages.length;a++)this.unloadPage(this.pages[a]);this.showPage(this.currentPage);this.opts.scaleToFit&&this.scaleToFit();this.positionBookShadow()},
pdfLoadPage:function(a,b){var c=d("<canvas>");this.opts.pdfProgressiveRender&&c.appendTo(this.pages[a].find(".wowbook-page-content"));this.pdfRenderPage(a,c[0],this.finishPageLoading)},pdfRenderPage:function(a,b,c,e,f){if(this.pdfPageRendering)this.pdfQueueRenderPage(a,b,c,e,f);else{this.pdfPageRendering=!0;var h=this;this.pdfDoc.getPage(a+1).then(function(f){e||(e=h.pdfFindScaleToFit());var l=f.getViewport(e*h.pdfCSS_UNITS*h.opts.pdfScale);b.height=l.height;b.width=l.width;var k={canvasContext:b.getContext("2d"),
viewport:l};f.render(k).then(function(){c.call(h,h.pages[a],b);h.pdfAnnotations(f,l,b,d(b).parent());h.pdfPageRendering=!1;h.pdfDequeueRenderPage()},function(){})})}},pdfAnnotations:function(a,b,c,e){var f=this;a.getAnnotations().then(function(c){b=b.clone({dontFlip:!0});var g="matrix("+b.transform.join(",")+")",l,k,m,n;m=0;for(n=c.length;m<n;m++)if((l=c[m])&&l.hasHtml&&"Link"==l.subtype&&(l.url||l.dest)){var q=l.rect;k=a.view;q=PDFJS.Util.normalizeRect([q[0],k[3]-q[1]+k[1],q[2],k[3]-q[3]+k[1]]);
k=d(PDFJS.AnnotationUtils.getHtmlElement(l,a.commonObjs));k.css({left:q[0]+"px",top:q[1]+"px",position:"absolute",transform:g,transformOrigin:-q[0]+"px "+-q[1]+"px"});l.url&&k.find("a").attr("target","_blank");if("Link"===l.subtype&&!l.url&&l.dest)k.find("a").addClass("internalLink").on("click",l,function(a){f.pdfNavigateTo(a.data.dest);return!1});e.append(k)}})},pdfNavigateTo:function(a){var b=this;b.pagesRefMap||(b.pagesRefMap={});var c=function(a){var d=a instanceof Object?b.pagesRefMap[a.num+
" "+a.gen+" R"]:a+1;d?b.gotoPage(d-1):b.pdfDoc.getPageIndex(a).then(function(d){b.pagesRefMap[a.num+" "+a.gen+" R"]=d+1;c(a)})};("string"==typeof a?this.pdfDoc.getDestination(a):Promise.resolve(a)).then(function(a){a instanceof Array&&c(a[0])})},pdfRenderThumbnail:function(a,b,c){this.thumbnailsContainer.addClass("wowbook-pdf");if((c=this.pages[a])&&!c.loading&&!b.pdf&&!b.rendering){b.rendering=!0;var e=b.find("canvas");e.length||(e=d("<canvas>").appendTo(b.find(".wowbook-page-content")));this.opts.pdfProgressiveRender||
e.css("display","none");b.find(".wowbook-page").css({width:b.width(),height:b.height(),zoom:1,transform:"scale(1)"});this.pdfRenderPage(a,e[0],function(a,c){e.css("display","block");b.rendering=!1;b.pdf=!0},this.thumbnailScale*this.opts.pdfScale,"thumb")}},pdfCancelRenderThumbnail:function(a,b){for(var c=this.pdfRenderQueue,e=0;e<c.length;){var d=c[e][0];d>=a&&d<=b&&"thumb"==c[e][4]?(this.thumbnails[d].rendering=!1,c.splice(e,1)):e++}},pdfQueueRenderPage:function(a,b,c,e,d){this.pdfRenderQueue.push([].slice.call(arguments))},
pdfDequeueRenderPage:function(){var a=this.pdfRenderQueue.shift();a&&this.pdfRenderPage.apply(this,a)},pdfFindScaleToFit:function(){var a=this.pageWidth,b=this.pageHeight,c=this.pdfWidth/this.pdfHeight;b*c>a&&(b=a/c);return b/this.pdfHeight},lightbox:function(a){this._lightboxElem=d("<div class='wowbook-lightbox'>").appendTo("body");this._lightboxBookContainer=d("<div class='wowbook-container'>").appendTo(this._lightboxElem);this._lightboxOverlay=this.opts.lightboxOverlay?d("<div class='wowbook-lightbox-overlay'>").appendTo("body"):
d();this.opts.thumbnailsParent=this._lightboxElem;this.opts.tocParent=this._lightboxElem;this.opts.fullscreenElement=this._lightboxElem;this.opts.lightboxResponsive&&(this.opts.scaleToFit=this._lightboxBookContainer,this.responsive());this._isMobile&&this._lightboxElem.addClass("wowbook-mobile");this.opts.lightboxColor&&this._lightboxElem.css("backgroundColor",this.opts.lightboxColor);this.opts.lightboxOverlayColor&&this._lightboxOverlay.css("backgroundColor",this.opts.lightboxOverlayColor);this._lightboxElem.css({width:this.opts.lightboxWidth,
height:this.opts.lightboxHeight});this.elem.appendTo(this._lightboxBookContainer);this.opts.toolbar&&(this.opts.toolbarParent=this._lightboxElem,this._isMobile&&(this.opts.toolbarLightboxPosition="bottom"));var b=this;d(a).on("click.wowbook",function(){b.showLightbox()});d("<button class='wowbook-close'>\u2715</button>").appendTo(this._lightboxElem).on("click.wowbook",function(){b.hideLightbox()})},destroyLightbox:function(a){d(this._lightboxElem).remove();d(this._lightboxOverlay).remove()},showLightbox:function(){this.thumbnailsContainer&&
this.thumbnailsContainer.parent()[0]!=this._lightboxElem&&this.thumbnailsContainer.appendTo(this._lightboxElem);this.elem.parent()[0]!=this._lightboxBookContainer&&this.elem.appendTo(this._lightboxBookContainer);this.tocContainer&&this.tocContainer.parent()[0]!=this._lightboxElem&&this.tocContainer.appendTo(this._lightboxElem);this.lightboxOn=!0;this._lightboxElem.show();this.centerLightbox();this._lightboxOverlay.show();this.positionBookShadow();if(this.opts.toolbarParent==this._lightboxElem){var a=
d(this.toolbars[0]).outerHeight(!0),b="top"==this.opts.toolbarLightboxPosition?"top":"bottom";this._lightboxBookContainer.css(b,a);d(this.toolbars[0]).css(b,0)}this.opts.lightboxResponsive&&this.responsiveUpdater();this._isMobile&&this.updateMobileToolbar();this.opts.onShowLightbox&&this.opts.onShowLightbox.call(this,this.pages[this.currentPage],this.currentPage)},hideLightbox:function(){this.lightboxOn=!1;this._lightboxElem.hide();this._lightboxOverlay.hide();this.opts.onHideLightbox&&this.opts.onHideLightbox.call(this,
this.pages[this.currentPage],this.currentPage)},centerLightbox:function(){var a=d(window).width(),b=d(window).height();this._lightboxElem.css("left",(a-this._lightboxElem.outerWidth())/2);this._lightboxElem.css("top",(b-this._lightboxElem.outerHeight())/2)},controllify:function(a){var b=this;d(a.zoomIn||a.zoomin).on("click.wowbook",function(){b.zoomIn({});return!1});d(a.zoomOut||a.zoomout).on("click.wowbook",function(){b.zoomOut({});return!1});d(a.zoomReset||a.zoomreset).on("click.wowbook",function(){b.zoomReset({});
return!1});d(a.next).on("click.wowbook",function(){b.advance();return!1});d(a.back).on("click.wowbook",function(){b.back();return!1});d(a.first).on("click.wowbook",function(){b.gotoPage(0);return!1});d(a.last).on("click.wowbook",function(){b.gotoPage(b.pages.length-1);return!1});d(a.slideShow||a.slideshow).on("click.wowbook",function(){b.toggleSlideShow();return!1});d(a.flipSound||a.flipsound).on("click.wowbook",function(){b.toggleFlipSound();return!1});d(a.thumbnails).on("click.wowbook",function(){b.toggleThumbnails();
return!1});d(a.fullscreen).on("click.wowbook",function(){b.toggleFullscreen();return!1});d(a.toc).on("click.wowbook",function(){b.toggleToc();return!1});d(a.fullscreen).length&&!w&&d(a.fullscreen).hide();var c=this.opts.downloadURL||this.opts.downloadurl||this.opts.downloadUrl||this.opts.pdf;c&&d(a.download).attr("href",c).attr("download",c);for(var c="zoomIn zoomOut zoomReset next back first last slideShow flipSound thumbnails fullscreen toc currentPage pageCount".split(" "),e,f=0,h=c.length;f<h;f++)e=
c[f].toLowerCase(),this._controls[e]=d(this._controls[e]).add(a[c[f]]||a[e])},toggleControl:function(a,b){(a=this._controls[a.toLowerCase()])&&d(a).toggleClass("wowbook-disabled",b)},toolbarControls:{_default:"<a href='#'><i></i></a>",first:"<a title='go to first page'><i></i></a>",back:"<a title='go back one page'><i></i></a>",next:"<a title='go foward one page'><i></i></a>",last:"<a title='go to last page'><i></i></a>",zoomin:"<a title='zoom in'><i></i></a>",zoomout:"<a title='zoom out'><i></i></a>",
slideshow:"<a title='start slideshow'><i></i></a>",flipsound:"<a title='flip sound on/off'><i></i></a>",fullscreen:"<a title='fullscreen on/off'><i></i></a>",thumbnails:"<a title='thumbnails on/off'><i></i></a>",toc:"<a title='table of contents on/off'><i></i></a>",download:"<a title='download'><i></i></a>"},createToolbar:function(a,b){if(a&&(b=d(b||this.opts.toolbarParent||this.elem.parent()))&&b.length){var c=d('<div class="wowbook-toolbar">'),e=d('<div class="">').appendTo(c);this.opts.toolbarIcons&&
c.addClass("wowbook-"+this.opts.toolbarIcons);a=a.split(/\s*,\s*/);for(var f={},h,g=0;g<a.length;g+=1)h=this.createToolbarControl(a[g]),f[a[g]]=h,e.append(h);this.opts.removeStickyHoverStyle&&(c.on("touchstart",".wowbook-control",function(){d(this).removeClass("remove-sticky-hover-style")}),c.on("touchend",".wowbook-control",function(){d(".remove-sticky-hover-style").removeClass("remove-sticky-hover-style");d(this).addClass("remove-sticky-hover-style")}));b.prepend(c);this.controllify(f);this.toolbars.push(c[0]);
return c}},destroyToolbars:function(){this.toolbars&&d(this.toolbars).remove();this.toolbars=null},createToolbarControl:function(a){this._avoidLoopControl||(this._avoidLoopControl={});var b=a;if(d.isPlainObject(a)){var c=a;a=d(this.toolbarControls._default);for(prop in c)if(jQuery.isFunction(a[prop]))a[prop](c[prop]);else a.attr(prop,c[prop])}if("string"==typeof a)if("<"==a.charAt(0))a=d(a);else{a=this.toolbarControls[a]||this.toolbarControls._default;if(this._avoidLoopControl[a])return"Error CreateToolbarControl in loop";
this._avoidLoopControl[a]=1;a=this.createToolbarControl(a);this._avoidLoopControl[a]=0;a=d(a).addClass("wowbook-control-"+b)}a.addClass("wowbook-control");return a},setupMobileToolbar:function(){this.opts.toolbarLightboxPosition="bottom";this.mobileToolbar=d(this.toolbars[0]);this.mobileToolbar.find(".wowbook-controls").css({position:"absolute",left:0});this.createMobileToolbarToggle();this.slideDownMobileToolbar(0);this.updateMobileToolbar()},toolbarIsExpandable:function(a){return 1.1*a.height()<
a.find(".wowbook-controls").height()},updateMobileToolbar:function(){this.mobileToolbarToggle.toggleClass("wowbook-collapsed",!this._mobileToolbarExpanded);this.mobileToolbarToggle.toggle(this.toolbarIsExpandable(this.mobileToolbar))},createMobileToolbarToggle:function(){this.mobileToolbarToggle=d("<a class='wowbook-control wowbook-control-toggle-toolbar'><i></i></a>").prependTo(this.mobileToolbar.find(".wowbook-controls"));var a=this;this.mobileToolbarToggle.on("click",function(){a.toogleMobileToolbar()});
d(window).on("resize.wowbook",function(){a.mobileToolbarToggle&&a.mobileToolbar&&a.updateMobileToolbar()})},slideUpMobileToolbar:function(a){var b=this.mobileToolbar.find(".wowbook-controls"),c=this.mobileToolbar.children().height()-this.mobileToolbar.height();b.css({bottom:-c}).animate({bottom:0},a);this._mobileToolbarExpanded=!0;this.updateMobileToolbar()},slideDownMobileToolbar:function(a){var b=this.mobileToolbar.find(".wowbook-controls"),c=this.mobileToolbar.children().height()-this.mobileToolbar.height();
b.animate({bottom:-c},{duration:a,complete:function(){d(this).css("bottom","")}});this._mobileToolbarExpanded=!1;this.updateMobileToolbar()},toogleMobileToolbar:function(){this._mobileToolbarExpanded?this.slideDownMobileToolbar():this.slideUpMobileToolbar()},translate:function(a,b,c,e){d.wowBook.support.transform&&!1!==e?a.css("transform",d.wowBook.useTranslate3d?"translate3d("+(b||0)+"px, "+(c||0)+"px, 0px)":"translate("+(b||0)+"px, "+(c||0)+"px) "):(void 0!==b&&a.css({left:b}),void 0!==c&&a.css({top:c}))}};
d.wowBook.defaults={width:500,height:300,pageWidth:void 0,pageHeight:void 0,coverWidth:void 0,coverHeight:void 0,startPage:0,hardcovers:!1,hardPages:!1,closable:!0,centeredWhenClosed:!1,doublePages:".double",rtl:!1,responsive:!1,scaleToFit:"",maxWidth:void 0,maxHeight:void 0,onResize:null,responsiveHandleWidth:void 0,singlePage:!1,responsiveSinglePage:!0,fullscreenElement:document.documentElement,onFullscreenError:null,use3d:!0,perspective:2E3,useTranslate3d:"mobile",useScale3d:!0,pageThickness:0,
pageEdgeColor:null,hardPageShadow:!0,bookShadow:!0,gutterShadow:!0,shadowThreshold:20,shadows:!0,foldGradient:!0,foldGradientThreshold:20,pageNumbers:!0,firstPageNumber:1,numberedPages:!1,deepLinking:!0,updateBrowserURL:!0,moveToViewPort:!1,curl:!0,curlSize:40,slideShow:!1,slideShowDelay:1E3,slideShowLoop:!1,pauseOnHover:!0,touchEnabled:!0,mouseWheel:!1,handleWidth:!1,handleClickDuration:300,turnPageDuration:1E3,turnPageDurationMin:300,forceBasicPage:!1,sections:".wowbook-section",pdf:null,pdfScale:1,
pdfProgressiveRender:!1,onPDFLoadError:null,zoomLevel:1,zoomMax:2,zoomMin:1,zoomBoundingBox:window,zoomStep:.25,zoomDuration:200,zoomEasing:"linear",onZoom:null,pinchToZoom:!0,allowDragBrowserPageZoom:!1,flipSound:!0,flipSoundFile:["page-flip.mp3","page-flip.ogg"],flipSoundPath:"./wow_book/sound/",onPlayFlipSound:null,keyboardNavigation:{back:37,advance:39},clipBoundaries:!0,onShowPage:null,onHoldPage:null,onReleasePage:null,pagesInMemory:null,pagesToKeep:null,onLoadPage:null,onUnloadPage:null,lightbox:null,
lightboxOverlay:!1,lightboxWidth:"100%",lightboxHeight:"100%",lightboxResponsive:!0,onShowLightbox:void 0,onHideLightbox:void 0,toc:void 0,tocParent:"body",tocHeader:"Table of contents",tocItemTemplate:void 0,toolbarLightboxPosition:"bottom",controls:{},downloadURL:null,toolbar:!1,toolbarParent:"body",toolbarIcons:"fontawesome",removeStickyHoverStyle:!0,thumbnails:!1,thumbnailsParent:"body",thumbnailScale:.2,thumbnailWidth:null,thumbnailHeight:null,thumbnailsPosition:null,thumbnailsVertical:!0,thumbnailsContainerWidth:null,
thumbnailsContainerHeight:null,thumbnailsSprite:null,thumbnailsAnimOptions:{}};"undefined"!=typeof QUnit&&(d.wowBook.wowBook=r);window.raf=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();d.browser.ie8mode=d.browser.msie&&8==document.documentMode;d.browser.ie7=d.browser.msie&&(7==d.browser.version||7==document.documentMode);var k=d.browser.msie&&9>d.browser.version?1:0,q={thin:2-k,medium:4-
k,thick:6-k},n=window.document,z=n.documentElement,w=z.requestFullscreen||z.mozRequestFullScreen||z.webkitRequestFullscreen||z.msRequestFullscreen,A=n.exitFullscreen||n.mozCancelFullScreen||n.webkitExitFullscreen||n.msExitFullscreen;d.wowBook.utils={translate:function(a,b,c){return d.wowBook.useTranslate3d?"translate3d("+a+"px, "+b+"px, "+(c||0)+"px) ":"translate("+a+"px, "+b+"px) "},isMobile:function(){return 480>=d(window).width()||480>=d(window).height()}}})(jQuery);
(function(d){function r(m){var k=m||window.event,q=[].slice.call(arguments,1),n=0,r=0,t=0;m=d.event.fix(k);m.type="mousewheel";k.wheelDelta&&(n=k.wheelDelta/120);k.detail&&(n=-k.detail/3);t=n;void 0!==k.axis&&k.axis===k.HORIZONTAL_AXIS&&(t=0,r=-1*n);void 0!==k.wheelDeltaY&&(t=k.wheelDeltaY/120);void 0!==k.wheelDeltaX&&(r=-1*k.wheelDeltaX/120);q.unshift(m,n,r,t);return(d.event.dispatch||d.event.handle).apply(this,q)}var v=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks)for(var t=v.length;t;)d.event.fixHooks[v[--t]]=
d.event.mouseHooks;d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var d=v.length;d;)this.addEventListener(v[--d],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var d=v.length;d;)this.removeEventListener(v[--d],r,!1);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(d){return d?this.bind("mousewheel",d):this.trigger("mousewheel")},unmousewheel:function(d){return this.unbind("mousewheel",d)}})})(jQuery);
(function(d){function r(m){if(m in v.style)return d.wowBook.support[m]=m;for(var k=t.length,q,n=m.charAt(0).toUpperCase()+m.substr(1);k--;)if(q=t[k]+n,q in v.style)return d.wowBook.support[m]=q}if(d.cssHooks){var v=document.createElement("div"),t=["O","ms","Webkit","Moz"];r("transform");r("transformOrigin");r("boxSizing");r("zoom");d.wowBook.support.boxSizing&&8>document.documentMode&&(d.wowBook.support.boxSizing=!1);v=null;d.each(["transform","transformOrigin"],function(m,k){d.wowBook.support[k]&&
d.wowBook.support[k]!==k&&!d.cssHooks[k]&&(d.cssHooks[k]={get:function(m,n,r){return d.css(m,d.wowBook.support[k])},set:function(m,n){m.style[d.wowBook.support[k]]=n}})});d.wowBook.applyAlphaImageLoader=function(m){var k,q,n,r,t="",v=d("<div style='display:none'></div>").appendTo("body");q=0;for(n=m.length;q<n;q++)if(r=m[q],v.addClass(r),k=v.css("background-image").match(/^url\("(.*)"\)$/))t+="."+r+"{background:none; filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+k[1]+"', sizingMethod='scale'); } ",
v.removeClass(r);d("body").append("<style>"+t+"</style>")}}else alert("jQuery 1.4.3+ is needed for this plugin to work")})(jQuery);